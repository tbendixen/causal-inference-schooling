<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Benjamin Grant Purzycki">
<meta name="author" content="Theiss Bendixen">

<title>Material insecurity and religiosity: A causal analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="notebook_files/libs/clipboard/clipboard.min.js"></script>
<script src="notebook_files/libs/quarto-html/quarto.js"></script>
<script src="notebook_files/libs/quarto-html/popper.min.js"></script>
<script src="notebook_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="notebook_files/libs/quarto-html/anchor.min.js"></script>
<link href="notebook_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="notebook_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="notebook_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="notebook_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="notebook_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a>
  <ul class="collapse">
  <li><a href="#set-up-and-data-preparation" id="toc-set-up-and-data-preparation" class="nav-link" data-scroll-target="#set-up-and-data-preparation"><span class="toc-section-number">1.1</span>  Set-up and data preparation</a></li>
  </ul></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="toc-section-number">2</span>  Simpsons “paradox”</a></li>
  <li><a href="#monotonic-vs.-gaussian-process" id="toc-monotonic-vs.-gaussian-process" class="nav-link" data-scroll-target="#monotonic-vs.-gaussian-process"><span class="toc-section-number">3</span>  Monotonic vs.&nbsp;Gaussian process</a>
  <ul class="collapse">
  <li><a href="#monotonic-global-model" id="toc-monotonic-global-model" class="nav-link" data-scroll-target="#monotonic-global-model"><span class="toc-section-number">3.1</span>  Monotonic global model</a></li>
  <li><a href="#gaussian-process-global-model" id="toc-gaussian-process-global-model" class="nav-link" data-scroll-target="#gaussian-process-global-model"><span class="toc-section-number">3.2</span>  Gaussian process global model</a></li>
  <li><a href="#monotonic-multilevel-model" id="toc-monotonic-multilevel-model" class="nav-link" data-scroll-target="#monotonic-multilevel-model"><span class="toc-section-number">3.3</span>  Monotonic multilevel model</a></li>
  <li><a href="#gaussian-process-multilevel-model" id="toc-gaussian-process-multilevel-model" class="nav-link" data-scroll-target="#gaussian-process-multilevel-model"><span class="toc-section-number">3.4</span>  Gaussian process multilevel model</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="toc-section-number">3.5</span>  Model comparison</a></li>
  <li><a href="#final-model" id="toc-final-model" class="nav-link" data-scroll-target="#final-model"><span class="toc-section-number">3.6</span>  Final model</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="toc-section-number">4</span>  Results</a>
  <ul class="collapse">
  <li><a href="#food-security" id="toc-food-security" class="nav-link" data-scroll-target="#food-security"><span class="toc-section-number">4.1</span>  Food security</a></li>
  <li><a href="#years-of-formal-education" id="toc-years-of-formal-education" class="nav-link" data-scroll-target="#years-of-formal-education"><span class="toc-section-number">4.2</span>  Years of formal education</a></li>
  </ul></li>
  <li><a href="#multilevel-regression-with-poststratification" id="toc-multilevel-regression-with-poststratification" class="nav-link" data-scroll-target="#multilevel-regression-with-poststratification"><span class="toc-section-number">5</span>  Multilevel Regression with Poststratification</a></li>
  <li><a href="#identifiability-assumptions" id="toc-identifiability-assumptions" class="nav-link" data-scroll-target="#identifiability-assumptions"><span class="toc-section-number">6</span>  Identifiability assumptions</a></li>
  <li><a href="#r-packages-versions-and-dependencies" id="toc-r-packages-versions-and-dependencies" class="nav-link" data-scroll-target="#r-packages-versions-and-dependencies"><span class="toc-section-number">7</span>  R packages, versions, and dependencies</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">8</span>  References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Material insecurity and religiosity: A causal analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Benjamin Grant Purzycki </p>
             <p>Theiss Bendixen </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This notebook fits and reports on the main and supplementary models for our analysis on religious commitment as predicted by food insecurity and educational attainment.</p>
<p>We first discuss and demonstrate the impact on inference between accounting versus not accounting for group-level structures – sometimes referred to as Simpson’s “paradox”.</p>
<p>We then fit and compare two approaches to modeling years of formal education and age – namely, via Gaussian processes and monotonic effects. Then, we fit our main analysis, as reported in the submitted manuscript and compare the marginal predictions to a model that post-stratify predictions to a different, non-sampled population.</p>
<p>Finally, we list and cite all <code>R</code> packages, their dependencies, and version number used for this project.</p>
<section id="set-up-and-data-preparation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="set-up-and-data-preparation"><span class="header-section-number">1.1</span> Set-up and data preparation</h2>
<p>We first load relevant packages and specify the path to <code>cmdstan</code>, the engine for fitting Bayesian models. We then read in the data and subset to relevant variables and complete cases. We then set the variables to their respective types. We also write generic fitting functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes) <span class="co"># for post-processing and plotting</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co"># for Bayesian modeling</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for data preparation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># for plotting</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grateful) <span class="co"># for citing packages</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># for panel plots</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase memory allocation</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="at">size=</span><span class="dv">56000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set path to whereever cmdstan in installed</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cmdstanr<span class="sc">::</span><span class="fu">set_cmdstan_path</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">cmdstan</span><span class="sc">\\</span><span class="st">cmdstan-2.29.0"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data and retain only complete cases</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"ALLSITES_V3.7_tabdel.txt"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SITE"</span>, <span class="st">"CID"</span>, <span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"CHILDREN"</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"FORMALED"</span>, <span class="st">"MAT1"</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"BGTHINK"</span>, <span class="st">"BGPERFHO"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[labs]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">complete.cases</span>(d), ]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for ordered categorical modeling</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>BGTHINK <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>BGTHINK, <span class="at">ordered =</span> T)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>BGPERFHO <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>BGPERFHO, <span class="at">ordered =</span> T)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># binary variables as factors</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>SEX <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>SEX)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>MAT1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>MAT1)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare monotonic modeling</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>FORMALED.mo <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>FORMALED, <span class="at">ordered =</span> T)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>AGE.mo <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>AGE, <span class="at">ordered =</span> T)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>CHILDREN.mo <span class="ot">&lt;-</span> <span class="fu">factor</span>(d<span class="sc">$</span>CHILDREN, <span class="at">ordered =</span> T)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generic fitting functions</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>fit_brms <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, priors, data) {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">formula =</span> formula,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data, </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> priors,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"logit"</span>),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1992</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># For prior predictive check</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>fit_brms_ppc <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, priors, data) {</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">formula =</span> formula,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data, </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> priors,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="st">"logit"</span>),</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">1992</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co"># For simple prior vs. posterior check</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>prior_vs_post <span class="ot">&lt;-</span> <span class="cf">function</span>(prior_model, post_model) {</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  ndraws <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1992</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>pvp <span class="ot">&lt;-</span> (<span class="fu">pp_check</span>(prior_model,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">ndraws =</span> ndraws,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">"bars"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span> </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior predictive check"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"How often do you think about [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">pp_check</span>(prior_model,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, </span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>              <span class="at">ndraws =</span> ndraws,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">"bars"</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span> </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior predictive check"</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"How often do you perform activities or practices</span><span class="sc">\n</span><span class="st"> to talk to or appease [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">pp_check</span>(post_model, </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                  <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ndraws =</span> ndraws,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"bars"</span>,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">freq =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior predictive check"</span>,</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"How often do you think about [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">pp_check</span>(post_model, </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>                  <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ndraws =</span> ndraws,</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"bars"</span>,</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">freq =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior predictive check"</span>,</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"How often do you perform activities or practices</span><span class="sc">\n</span><span class="st"> to talk to or appease [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>              patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(pvp)</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="simpsons-paradox" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Simpsons “paradox”</h1>
<p>As reviewed in the main manuscript, some previous research analyzes group-level association between various sociodemographic factors and religious commitment and finds, for instance, that years of education negatively predicts religiosity. Here, using simple bivariate regressions, we show how analyzing group-mean aggregated can potentially lead us astray. This is sometimes referred to as Simpson’s paradox, although technically there’s no paradox. It’s simply a result of nested data structures.</p>
<p>Specifically, in the following graphs, we replicate previous findings that, on a group-mean aggregate level, there’s a negative relationship between education and religiosity (left panel), but that this relationship disappears when taking into account the grouping structure in the data (namely, the field sites; right panel). One way to think of this phenomenon is to consider the field sites as proxies for unobserved, site-specific confounding factors that are (at least partly) mitigated, when allowing each site to have its own intercept and slope.</p>
<div class="cell" data-hash="notebook_cache/html/simps-think_603e58ee51a3ce1077640f7926aa8bd8">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d_agg <span class="ot">&lt;-</span> <span class="fu">with</span>(d, <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SITE =</span> <span class="fu">unique</span>(d<span class="sc">$</span>SITE),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">FORMALED =</span> <span class="fu">aggregate</span>(<span class="fu">as.numeric</span>(FORMALED), <span class="fu">list</span>(SITE), <span class="at">FUN =</span> mean)<span class="sc">$</span>x,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">BGTHINK =</span> <span class="fu">aggregate</span>(<span class="fu">as.numeric</span>(BGTHINK), <span class="fu">list</span>(SITE), <span class="at">FUN =</span> mean)<span class="sc">$</span>x,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">BGPERFHO =</span> <span class="fu">aggregate</span>(<span class="fu">as.numeric</span>(BGPERFHO), <span class="fu">list</span>(SITE), <span class="at">FUN =</span> mean)<span class="sc">$</span>x)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>(d_agg <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FORMALED, <span class="at">y =</span> BGTHINK)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Years of formal education (group-mean)"</span>) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Religious ideation (group-mean)"</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's ''paradox''"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Formal education and religious ideation"</span>)) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>(d <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(FORMALED), <span class="at">y =</span> <span class="fu">as.numeric</span>(BGTHINK), <span class="at">color =</span> SITE)) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> SITE) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Years of formal education"</span>) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Religious ideation"</span>)) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/simps-think-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell" data-hash="notebook_cache/html/simps-perfho_c501a83818170e676ae616523a174a87">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(d_agg <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FORMALED, <span class="at">y =</span> BGPERFHO))) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Years of formal education (group mean)"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Religious behavior (group mean)"</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's ''paradox''"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Formal education and religious behavior"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>(d <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(FORMALED), <span class="at">y =</span> <span class="fu">as.numeric</span>(BGPERFHO), <span class="at">color =</span> SITE))) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> SITE) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Years of formal education"</span>) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Religious behavior"</span>) <span class="sc">+</span>  </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/simps-perfho-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="monotonic-vs.-gaussian-process" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Monotonic vs.&nbsp;Gaussian process</h1>
<p>In this section, we fit four models. One set of models approach years of formal education and age as monotonic, first without (<code>m1mo</code>) and then with (<code>m2mo</code>) by-site clustering.</p>
<p>The second set of models handles years of formal education and age with Gaussian processes, again without (<code>m1gp</code>) and with (<code>m2gp</code>) by-site clustering. We then compare the models (<code>m1mo</code> vs.&nbsp;<code>m1gp</code> vs.&nbsp;<code>m2mo</code> vs.&nbsp;<code>m2gp</code>), using approximate leave-one-out cross-validation <span class="citation" data-cites="loo2017b loo2017c loo2020a">(<a href="#ref-loo2017b" role="doc-biblioref">Vehtari, Gelman, and Gabry 2017</a>; <a href="#ref-loo2017c" role="doc-biblioref">Yao et al. 2017</a>; <a href="#ref-loo2020a" role="doc-biblioref"><strong>loo2020a?</strong></a>)</span>.</p>
<p>For the monotonic models, we specify mildly regularizing priors on all parameters. For the Gaussian process models, we specify mildly regularizing priors on the cut-points (what <code>brms</code> refers to as “Intercepts”) but stick with the default priors for the Gaussian process parameters themselves. Priors potentially play an important role in Gaussian process models and <code>brms</code> defaults to priors that are mildly catered to the data at hand (without encoding any particular relationship <em>a priori</em>).</p>
<p>In any case, our dataset is fairly large and to ensure that the posterior is in fact informed by the data, we plot convenient prior vs.&nbsp;posterior predictive checks for each model in turn. For computational ease, the prior vs.&nbsp;posterior checks are based on 100 draws from the posterior, so the point estimates (posterior medians) and 90% intervals are only indicative of the full posterior distribution.</p>
<section id="monotonic-global-model" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="monotonic-global-model"><span class="header-section-number">3.1</span> Monotonic global model</h2>
<div class="cell" data-hash="notebook_cache/html/m1mo_c22492305a5e116a628c59d21874cbf3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>m1mopriors <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"normal(0,0.5)"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"b"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,0.5)"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"b"</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moAGE.mo1"</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moFORMALED.mo1"</span>) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moAGE.mo1"</span>) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moFORMALED.mo1"</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>m1moformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">mo</span>(FORMALED.mo) <span class="sc">+</span> <span class="fu">mo</span>(AGE.mo)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>m1moppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> m1moformula, <span class="at">priors =</span> m1mopriors, <span class="at">data =</span> d)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>m1mo <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> m1moformula, <span class="at">priors =</span> m1mopriors, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/m1moppc_46f1e402fcd70d0d72d5e4877904a31c">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(m1moppc, m1mo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/m1moppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="gaussian-process-global-model" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="gaussian-process-global-model"><span class="header-section-number">3.2</span> Gaussian process global model</h2>
<div class="cell" data-hash="notebook_cache/html/m1gp_7b9bc0ae1e23faeda50b9423998d9d45">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m1gppriors <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"normal(0,2.5)"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,2.5)"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>m1gpformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">gp</span>(FORMALED) <span class="sc">+</span> <span class="fu">gp</span>(AGE)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>m1gpppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> m1gpformula, <span class="at">priors =</span> m1gppriors, <span class="at">data =</span> d)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>m1gp <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> m1gpformula, <span class="at">priors =</span> m1gppriors, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/m1gpppc_a18b4442c5cc589c2df52ffe0e5dea9f">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(m1gpppc, m1gp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/m1gpppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="monotonic-multilevel-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="monotonic-multilevel-model"><span class="header-section-number">3.3</span> Monotonic multilevel model</h2>
<div class="cell" data-hash="notebook_cache/html/m2mo_2d2f06b94597732dd2d5200a2a67b48d">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>m2mopriors <span class="ot">&lt;-</span> m1mopriors <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"lkj_corr_cholesky(4)"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"L"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>m2moformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">mo</span>(FORMALED.mo) <span class="sc">+</span> <span class="fu">mo</span>(AGE.mo) <span class="sc">+</span> (<span class="fu">mo</span>(FORMALED.mo) <span class="sc">+</span> <span class="fu">mo</span>(AGE.mo) <span class="sc">|</span> SITE)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>m2moppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> m2moformula, <span class="at">priors =</span> m2mopriors, <span class="at">data =</span> d)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>m2mo <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> m2moformula, <span class="at">priors =</span> m2mopriors, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/m2moppc_17e89287a6d2ccf89240626af2bf639d">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(m2moppc, m2mo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/m2moppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="gaussian-process-multilevel-model" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="gaussian-process-multilevel-model"><span class="header-section-number">3.4</span> Gaussian process multilevel model</h2>
<div class="cell" data-hash="notebook_cache/html/m2gp_e7e27c134384b9fff8618cf1a81a4d21">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m2gpformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">gp</span>(FORMALED, <span class="at">by =</span> SITE) <span class="sc">+</span> <span class="fu">gp</span>(AGE, <span class="at">by =</span> SITE)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>m2gpppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> m2gpformula, <span class="at">priors =</span> m1gppriors, <span class="at">data =</span> d)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>m2gp <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> m2gpformula, <span class="at">priors =</span> m1gppriors, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/m2gpppc_357fd3ae974380cdf6821605381a0442">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(m2gpppc, m2gp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/m2gpppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="model-comparison" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">3.5</span> Model comparison</h2>
<p>Comparing <code>m1mo</code> vs.&nbsp;<code>m1gp</code> vs.&nbsp;<code>m2mo</code> vs.&nbsp;<code>m2gp:</code></p>
<div class="cell" data-hash="notebook_cache/html/loo_11e7f76e64db280fbc579c4341e9ed6c">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>loo_result <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(<span class="fu">loo</span>(m1mo), <span class="fu">loo</span>(m2mo), <span class="fu">loo</span>(m1gp), <span class="fu">loo</span>(m2gp))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>loo_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     elpd_diff se_diff
m2mo     0.0       0.0
m1gp  -627.4      46.4
m1mo  -628.2      46.6
m2gp -1463.5      90.7</code></pre>
</div>
</div>
<p>Note that for the multilevel Gaussian process, we had some mild convergence issues, which are likely to also impact the model comparison results. We suspect that some of these issues could be solved using a combination of longer chains, stronger priors, and/or informative scaling and centering of the independent variables.</p>
<p>However, given that the monotonic effects models perform just as well or even better than the Gaussian process models and are also arguably more parsimonious in that we do not have to assume any particular density kernel <em>a priori</em> (as with the Gaussian process model), we proceed with the monotonic effects parameterization.</p>
</section>
<section id="final-model" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="final-model"><span class="header-section-number">3.6</span> Final model</h2>
<div class="cell" data-hash="notebook_cache/html/m3mo_6665aa3729f95c3e9edcf7b7a2c93d38">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m3mopriors <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"normal(0,0.5)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,0.5)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, <span class="at">coef =</span> <span class="st">"moAGE.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, <span class="at">coef =</span> <span class="st">"moCHILDREN.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, <span class="at">coef =</span> <span class="st">"moFORMALED.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, <span class="at">coef =</span> <span class="st">"moAGE.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, <span class="at">coef =</span> <span class="st">"moCHILDREN.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, <span class="at">class=</span><span class="st">"simo"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, <span class="at">coef =</span> <span class="st">"moFORMALED.mo1"</span>) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"lkj_corr_cholesky(4)"</span>, <span class="at">class =</span> <span class="st">"L"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>m3moformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">mo</span>(FORMALED.mo) <span class="sc">+</span> <span class="fu">mo</span>(AGE.mo) <span class="sc">+</span> SEX <span class="sc">+</span> MAT1 <span class="sc">+</span> <span class="fu">mo</span>(CHILDREN.mo) <span class="sc">+</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                    (<span class="fu">mo</span>(FORMALED.mo) <span class="sc">+</span> <span class="fu">mo</span>(AGE.mo) <span class="sc">+</span> SEX <span class="sc">+</span> MAT1 <span class="sc">+</span> <span class="fu">mo</span>(CHILDREN.mo) <span class="sc">|</span> SITE)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>m3moppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> m3moformula, <span class="at">priors =</span> m3mopriors, <span class="at">data =</span> d)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>m3mo <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> m3moformula, <span class="at">priors =</span> m3mopriors, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/m3moppc_76842d7f13d89651909efd2e93f4fcf7">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(m3moppc, m3mo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/m3moppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We run model comparison to check if the final model indeed performs predictively better than the more simple models. Results indicate that this indeed is the case, although the difference between <code>m3mo</code> and <code>m2mo</code> is relatively small compared to its standard error.</p>
<div class="cell" data-hash="notebook_cache/html/loo-final_dd35dc131b7f92ebe42e3ba7b558b65e">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>loo_result_fin <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(<span class="fu">loo</span>(m1mo), <span class="fu">loo</span>(m2mo), <span class="fu">loo</span>(m1gp), <span class="fu">loo</span>(m2gp), <span class="fu">loo</span>(m3mo))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>loo_result_fin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     elpd_diff se_diff
m3mo     0.0       0.0
m2mo    -3.8       6.1
m1gp  -631.2      46.3
m1mo  -632.0      46.5
m2gp -1467.3      90.8</code></pre>
</div>
</div>
</section>
</section>
<section id="results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Results</h1>
<p>Here, we produce the result plots reported in the main manuscript.</p>
<section id="food-security" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="food-security"><span class="header-section-number">4.1</span> Food security</h2>
<div class="cell" data-hash="notebook_cache/html/g-comp-bin_5148cfdbc89a50310490571b98a7bdc1">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>g_comp_bin <span class="ot">&lt;-</span> <span class="cf">function</span>(model, resp) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1992</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prediction grid</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  predgrid <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">transform</span>(d, <span class="at">MAT1 =</span> <span class="dv">0</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">MAT1 =</span> <span class="dv">1</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get fitted values</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  epred <span class="ot">&lt;-</span> <span class="fu">add_epred_draws</span>(<span class="at">object =</span> model, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ndraws =</span> <span class="dv">2000</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> predgrid, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">re_formula =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">resp =</span> resp) <span class="sc">|&gt;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">factor</span>(<span class="fu">as.numeric</span>(.category)))</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute posterior means for ID and response option</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  fitted <span class="ot">&lt;-</span> epred <span class="sc">|&gt;</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CID, MAT1, SITE, category) <span class="sc">|&gt;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">post_mean =</span> <span class="fu">mean</span>(.epred)) <span class="sc">|&gt;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prepare line plot</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CID, category) <span class="sc">|&gt;</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">cur_group_id</span>()) <span class="sc">|&gt;</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare facet labels</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  site_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Co.Tanna"</span> <span class="ot">=</span> <span class="st">"Coastal Tanna"</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"In.Tanna"</span> <span class="ot">=</span> <span class="st">"Inland Tanna"</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Sursurunga"</span> <span class="ot">=</span> <span class="st">"Sursurunga"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Turkana"</span> <span class="ot">=</span> <span class="st">"Turkana"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Samburu"</span> <span class="ot">=</span> <span class="st">"Samburu"</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Huatasani"</span> <span class="ot">=</span> <span class="st">"Huatasani"</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Mysore"</span> <span class="ot">=</span> <span class="st">"Mysore"</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Cachoeira"</span> <span class="ot">=</span> <span class="st">"Cachoeira"</span>,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Kananga"</span> <span class="ot">=</span> <span class="st">"Kananga"</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Mauritius"</span> <span class="ot">=</span> <span class="st">"Mauritius"</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Lovu"</span> <span class="ot">=</span> <span class="st">"Lovu Fiji"</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Marajo"</span> <span class="ot">=</span> <span class="st">"Marajo"</span>, </span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Tyva Republic"</span> <span class="ot">=</span> <span class="st">"Tyva Republic"</span>,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Yasawa"</span> <span class="ot">=</span> <span class="st">"Yasawa Fiji"</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> fitted <span class="sc">|&gt;</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MAT1, </span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> post_mean, </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group =</span> indices,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> category))  <span class="sc">+</span> </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">option =</span> <span class="st">"D"</span>,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Very rarely/never"</span>, </span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per year"</span>, </span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per month"</span>, </span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per week"</span>, </span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"Every day"</span>)) <span class="sc">+</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> <span class="co"># controls the legend alpha separately from the geom_line() alpha</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>SITE, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(site_labels)) <span class="sc">+</span> </span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Worried about food?"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>) ) <span class="sc">+</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">"Probability of each response option"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.92</span>, <span class="fl">0.1</span>),</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>),</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"transparent"</span>))</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/mat-think_b0c21f86d420884712362009dab7ebf1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">g_comp_bin</span>(m3mo, <span class="st">"BGTHINK"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"How often do you think about [deity]?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/mat-think-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell" data-hash="notebook_cache/html/mat-perfho_d1140a7adfb4cb04105dca7ac5957b2e">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">g_comp_bin</span>(m3mo, <span class="st">"BGPERFHO"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"How often do you perform activities or practices to talk to or appease [deity]?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/mat-perfho-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="years-of-formal-education" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="years-of-formal-education"><span class="header-section-number">4.2</span> Years of formal education</h2>
<div class="cell" data-hash="notebook_cache/html/g-comp-trend_f3cd9411fcc37fbc8741c338e1aa3ed1">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>g_comp_trend <span class="ot">&lt;-</span> <span class="cf">function</span>(model, resp) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1992</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prediction grid</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  predgrid <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">0</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">5</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">10</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">15</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">20</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">25</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">transform</span>(d, <span class="at">FORMALED.mo =</span> <span class="dv">30</span>))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get fitted values</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  epred <span class="ot">&lt;-</span> <span class="fu">add_epred_draws</span>(<span class="at">object =</span> model, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ndraws =</span> <span class="dv">2000</span>, </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> predgrid, </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">re_formula =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">resp =</span> resp) <span class="sc">|&gt;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">factor</span>(<span class="fu">as.numeric</span>(.category)))</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute posterior means for ID and response option</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  fitted <span class="ot">&lt;-</span> epred <span class="sc">|&gt;</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CID, FORMALED.mo, SITE, category) <span class="sc">|&gt;</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">post_mean =</span> <span class="fu">mean</span>(.epred)) <span class="sc">|&gt;</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prepare line plot</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CID, category) <span class="sc">|&gt;</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">cur_group_id</span>()) <span class="sc">|&gt;</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare facet labels</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  site_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Co.Tanna"</span> <span class="ot">=</span> <span class="st">"Coastal Tanna"</span>,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"In.Tanna"</span> <span class="ot">=</span> <span class="st">"Inland Tanna"</span>,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Sursurunga"</span> <span class="ot">=</span> <span class="st">"Sursurunga"</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Turkana"</span> <span class="ot">=</span> <span class="st">"Turkana"</span>,</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Samburu"</span> <span class="ot">=</span> <span class="st">"Samburu"</span>,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Huatasani"</span> <span class="ot">=</span> <span class="st">"Huatasani"</span>,</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Mysore"</span> <span class="ot">=</span> <span class="st">"Mysore"</span>,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Cachoeira"</span> <span class="ot">=</span> <span class="st">"Cachoeira"</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Kananga"</span> <span class="ot">=</span> <span class="st">"Kananga"</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Mauritius"</span> <span class="ot">=</span> <span class="st">"Mauritius"</span>,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Lovu"</span> <span class="ot">=</span> <span class="st">"Lovu Fiji"</span>,</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Marajo"</span> <span class="ot">=</span> <span class="st">"Marajo"</span>, </span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Tyva Republic"</span> <span class="ot">=</span> <span class="st">"Tyva Republic"</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Yasawa"</span> <span class="ot">=</span> <span class="st">"Yasawa Fiji"</span>)</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> fitted <span class="sc">|&gt;</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FORMALED.mo, </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> post_mean, </span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group =</span> indices,</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> category))  <span class="sc">+</span> </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">option =</span> <span class="st">"D"</span>,</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Very rarely/never"</span>, </span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per year"</span>, </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per month"</span>, </span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"A few times per week"</span>, </span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">"Every day"</span>)) <span class="sc">+</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> <span class="co"># controls the legend alpha separately from the geom_line() alpha</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>SITE, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(site_labels)) <span class="sc">+</span> </span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Years of formal education"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>,<span class="st">"20"</span>,<span class="st">"30"</span>)) <span class="sc">+</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">"Probability of each response option"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.92</span>, <span class="fl">0.1</span>),</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"transparent"</span>))</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/edu-think_e47ebb0f86d60a7e4fe19dd0a8795b59">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">g_comp_trend</span>(m3mo, <span class="st">"BGTHINK"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"How often do you think about [deity]?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/edu-think-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell" data-hash="notebook_cache/html/edu-perfho_9f9415d8808728483617c07f398ecccd">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">g_comp_trend</span>(m3mo, <span class="st">"BGPERFHO"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"How often do you perform activities or practices to talk to or appease [deity]?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/edu-perfho-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>
<section id="multilevel-regression-with-poststratification" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Multilevel Regression with Poststratification</h1>
<p>Our main model and plotted predictions yield inferences for the sampled sites and participants with complete-cases for the included variables, when hypothetically manipulating years of formal education. While our dataset is both culturally and demographically diverse, it’s not necessarily characteristic of any given population that we might be substantially interested in. Our results, then, potentially do not speak to any particular research question regarding any particular population.</p>
<p>For illustrative purposes, in this final section, we show how to go about obtaining predictions for a non-sampled but well-defined population, using so-called <em>poststratification</em>. Poststratification involves re-weighting a model’s predictions using weights obtained from external data that are more representative of the population of interest.</p>
<p>For the sake of the illustration, we consider poststratifying model predictions to Denmark, since Danish (as well as many other European countries) census-level data are readily available for the relevant variables of age, gender, and educational level. We want to stress, however, that we do not take the obtained poststratified results as given but rather as a purely methodological exercise and practical demonstration.</p>
<p>The general steps in poststratification is as follows (see blocked-out comments in code chunks for more detail):</p>
<ol type="1">
<li><p>We obtain external data that are more representative of a population of interest, such as from a census. For the present analysis, we used Eurostat, a datahub for European census data: https://ec.europa.eu/eurostat/databrowser/view/EDAT_LFS_9901__custom_5352473/default/table?lang=en.</p></li>
<li><p>We then load the external data and streamline the external data to our sample data set in terms of data structure, variables labels, etc.</p></li>
</ol>
<div class="cell" data-hash="notebook_cache/html/eurostat-prep_2603fb4cff6d7ae36e06a3f8c470bc60">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Construct external dataset to use for poststratification:</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://ec.europa.eu/eurostat/databrowser/view/EDAT_LFS_9901__custom_5352473/default/table?lang=en</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load external data for poststratification</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>eurostat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"eurostat2021.csv"</span>, <span class="at">sep =</span> <span class="st">";"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>psdf <span class="ot">&lt;-</span> eurostat <span class="co"># copy df</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># streamline name of education column</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(psdf)[<span class="fu">which</span>(<span class="fu">names</span>(psdf) <span class="sc">==</span> <span class="st">"ISCED11"</span>)] <span class="ot">&lt;-</span> <span class="st">"FORMALED"</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># bin demographic variables</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>SEX[psdf<span class="sc">$</span>SEX <span class="sc">==</span> <span class="st">"Females"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># women</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>SEX[psdf<span class="sc">$</span>SEX <span class="sc">==</span> <span class="st">"Males"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># men</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>AGE[psdf<span class="sc">$</span>AGE <span class="sc">==</span> <span class="st">"From 15 to 24 years"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 15-24</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>AGE[psdf<span class="sc">$</span>AGE <span class="sc">==</span> <span class="st">"From 25 to 34 years"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># 25-34</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>AGE[psdf<span class="sc">$</span>AGE <span class="sc">==</span> <span class="st">"From 35 to 44 years"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># 35-44</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>AGE[psdf<span class="sc">$</span>AGE <span class="sc">==</span> <span class="st">"From 45 to 54 years"</span>] <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># 45-54</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>AGE[psdf<span class="sc">$</span>AGE <span class="sc">==</span> <span class="st">"From 55 to 74 years"</span>] <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># 55-74</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>FORMALED[psdf<span class="sc">$</span>FORMALED <span class="sc">==</span> <span class="st">"Less than primary, primary and lower secondary education (levels 0-2)"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># primary to lower secondary</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>FORMALED[psdf<span class="sc">$</span>FORMALED <span class="sc">==</span> <span class="st">"Upper secondary and post-secondary non-tertiary education (levels 3 and 4)"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># # upper secondary and post-secondary non-tertiary education</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>psdf<span class="sc">$</span>FORMALED[psdf<span class="sc">$</span>FORMALED <span class="sc">==</span> <span class="st">"Tertiary education (levels 5-8)"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># tertiary education</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/ps-prep_46699b4ab12c8d5513259c9a3500862d">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin covariates according to Eurostat data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>d_mrp <span class="ot">&lt;-</span> d</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to achieve maximal coverage of age groups while retaining reasonable (i.e., not too large, not too small) bin sizes</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># consistent with externally available age ranges, we chose the following ranges:</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&lt;=</span> <span class="dv">24</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># below 24 (external age bin: 15-24)</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> d_mrp<span class="sc">$</span>AGE <span class="sc">&lt;=</span> <span class="dv">34</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># 25-34</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&gt;=</span> <span class="dv">35</span> <span class="sc">&amp;</span> d_mrp<span class="sc">$</span>AGE <span class="sc">&lt;=</span> <span class="dv">44</span>] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># 35-44</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&gt;=</span> <span class="dv">45</span> <span class="sc">&amp;</span> d_mrp<span class="sc">$</span>AGE <span class="sc">&lt;=</span> <span class="dv">54</span>] <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># 45-54</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&gt;=</span> <span class="dv">55</span> <span class="sc">&amp;</span> d_mrp<span class="sc">$</span>AGE <span class="sc">&lt;=</span> <span class="dv">74</span>] <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># 55-74</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE[d_mrp<span class="sc">$</span>AGE <span class="sc">&gt;</span> <span class="dv">74</span>] <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># above 74; will not be used to poststratify due to lack of external data for this group</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>AGE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d_mrp<span class="sc">$</span>AGE) <span class="co"># convert to factor</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>FORMALED[d_mrp<span class="sc">$</span>FORMALED <span class="sc">&lt;=</span> <span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># ISCED 11: 0-2, primary to lower secondary, c. 10 years of education</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>FORMALED[d_mrp<span class="sc">$</span>FORMALED <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> d_mrp<span class="sc">$</span>FORMALED <span class="sc">&lt;=</span> <span class="dv">16</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># ISCED 11: 3-4, upper secondary and post-secondary non-tertiary education, c. 5 years</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>FORMALED[d_mrp<span class="sc">$</span>FORMALED <span class="sc">&gt;=</span> <span class="fl">16.1</span>] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># ISCED 11: 5-8, tertiary education</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>d_mrp<span class="sc">$</span>FORMALED <span class="ot">&lt;-</span> <span class="fu">factor</span>(d_mrp<span class="sc">$</span>FORMALED, <span class="at">ordered =</span> <span class="cn">TRUE</span>) <span class="co"># convert to ordered factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Next, we analyze our sample data in a multilevel cross-classification model that includes varying effects of the included demographic variables. Cross-classification address the fact that some cells (i.e., combination of covariates) might contain few observations and, through partial pooling, these cells are then informed by all other cells. As above, we plot simple prior vs.&nbsp;posterior predictive checks.</li>
</ol>
<div class="cell" data-hash="notebook_cache/html/mrp_aadc858ab13550f1ca69840f085214e9">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mrppriors <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"b"</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"b"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,2.5)"</span>, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"normal(0,2.5)"</span>, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGTHINK"</span>, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moFORMALED1"</span>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"dirichlet(2)"</span>, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">class =</span> <span class="st">"simo"</span>, </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">coef =</span> <span class="st">"moFORMALED1"</span>) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">resp =</span> <span class="st">"BGTHINK"</span>) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">resp =</span> <span class="st">"BGPERFHO"</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">set_prior</span>(<span class="st">"lkj_corr_cholesky(4)"</span>, <span class="at">class =</span> <span class="st">"L"</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>mrpformula <span class="ot">&lt;-</span> <span class="fu">mvbind</span>(BGTHINK, BGPERFHO) <span class="sc">~</span> <span class="fu">mo</span>(FORMALED) <span class="sc">+</span> (<span class="fu">mo</span>(FORMALED) <span class="sc">|</span> SEX) <span class="sc">+</span> (<span class="fu">mo</span>(FORMALED) <span class="sc">|</span> AGE) <span class="sc">+</span> (<span class="fu">mo</span>(FORMALED) <span class="sc">|</span> SITE)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>mrpppc <span class="ot">&lt;-</span> <span class="fu">fit_brms_ppc</span>(<span class="at">formula =</span> mrpformula, <span class="at">priors =</span> mrppriors, <span class="at">data =</span> d_mrp)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>mrp <span class="ot">&lt;-</span> <span class="fu">fit_brms</span>(<span class="at">formula =</span> mrpformula, <span class="at">priors =</span> mrppriors, <span class="at">data =</span> d_mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="notebook_cache/html/mrpppc_fe3de55dcdc0da2a8e6e70848a337fae">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_vs_post</span>(mrpppc, mrp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/mrpppc-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<ol start="4" type="1">
<li>Then, we obtain poststratification weights from the external data. For each combination of covariates (gender, age, level of education), the weights are simply the proportion given by the number of Danes with this combination to the total number of Danes in the external data. These weights are then used to re-weigh the model predictions.</li>
</ol>
<div class="cell" data-hash="notebook_cache/html/ps-plot-prep_7d246048fbddae325e57cb57698c6b62">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get poststratification weights</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ps_prop <span class="ot">&lt;-</span> psdf  <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FORMALED) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> Value<span class="sc">/</span><span class="fu">sum</span>(Value)) <span class="sc">|&gt;</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># postratification function</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>poststratify <span class="ot">&lt;-</span> <span class="cf">function</span>(model, newdata, resp) {</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get predictions for new data</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  ps_fitted <span class="ot">&lt;-</span> <span class="fu">add_epred_draws</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">object =</span> model,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> newdata,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">resp =</span> resp,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ndraws =</span> <span class="dv">300</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># excluding site-specific variation</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="fu">mo</span>(FORMALED) <span class="sc">|</span> SEX) <span class="sc">+</span> (<span class="fu">mo</span>(FORMALED) <span class="sc">|</span> AGE), </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">allow_new_levels =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># re-weight model predictions using proportions from above</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">estimate =</span> .epred) <span class="sc">|&gt;</span> </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate_prop =</span> estimate<span class="sc">*</span>prop) <span class="sc">|&gt;</span> </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FORMALED, .draw, .category) <span class="sc">|&gt;</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">estimate_sum =</span> <span class="fu">sum</span>(estimate_prop)) <span class="sc">|&gt;</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># connect predictions for line plotting</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw, .category) <span class="sc">|&gt;</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">cur_group_id</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.epred =</span> estimate_sum)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="cn">NULL</span>)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ps_fitted)</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>ps_think <span class="ot">&lt;-</span> <span class="fu">poststratify</span>(mrp, ps_prop, <span class="st">"BGTHINK"</span>)</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>ps_perfho <span class="ot">&lt;-</span> <span class="fu">poststratify</span>(mrp, ps_prop, <span class="st">"BGPERFHO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Finally, the re-weighted predictions are plotted across available levels of formal education for each outcome.</li>
</ol>
<div class="cell" data-hash="notebook_cache/html/ps-plot_03b70231be015d7536667ab65a31106b">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting function</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ps_gcomp_trend <span class="ot">&lt;-</span> <span class="cf">function</span>(fitted){</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  fitted <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FORMALED, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> .epred, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">group =</span> indices,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> .category))  <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">option =</span> <span class="st">"D"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Very rarely/never"</span>, </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"A few times per year"</span>, </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"A few times per month"</span>, </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"A few times per week"</span>, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Every day"</span>)) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> <span class="co"># controls the legend alpha separately from the geom_line() alpha</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name=</span><span class="st">"Years of formal education (binned)"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-10"</span>,<span class="st">"11-16"</span>,<span class="st">"&gt;16"</span>), </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">"Probability of each response option"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># panel plotting </span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ps_gcomp_trend</span>(ps_think)) <span class="sc">+</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poststratified to Denmark"</span>, </span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"How often do you think about [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">ps_gcomp_trend</span>(ps_perfho)) <span class="sc">+</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poststratified to Denmark"</span>, </span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">subtitle =</span> <span class="st">"How often do you perform activities or practices</span><span class="sc">\n</span><span class="st"> to talk to or appease [deity]?"</span>) <span class="sc">+</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="notebook_files/figure-html/ps-plot-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>Now, notice that since years of formal education did not exhibit a clear effect on religious commitment in our sample data, the poststratified predictions are not qualitatively different from our main results. Consider too that our sample data were generally very religiously committed. Since the model is trained on this dataset, according to the poststratified predictions but counter to fact, Danes also come across as very religiously committed. We therefore stress again that, in the present study context, the poststratification exercise is purely a methodological illustration.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="identifiability-assumptions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Identifiability assumptions</h1>
<p>For our estimated effects to have valid causal interpretations, a set of identifiability assumptions need to be met.</p>
<p>First, the statistical model is assumed to not suffer from model misspecification, measurement bias, or unmodelled confounding (i.e., <em>conditional exchangeability</em>). Second, it’s assumed that the exposure and outcome of participants do not depend on other participants’ exposures and outcomes (i.e., <em>stable unit treatment value assumption</em> or <em>no interference</em>). Third, it’s assumed that the observed outcome under a given exposure for any given participant is equivalent to the potential outcome that would’ve been observed for that participant under that exposure (i.e., <em>counterfactual consistency</em>). Fourth, it’s assumed that all counterfactually manipulated levels and combinations of exposures and covariates are possible for all participants (i.e., <em>positivity</em>). This latter assumption can be relaxed to the extent that we’re willing to extrapolate the model’s predictions to ranges and combinations of exposures and covariates outside the observed sample. All these assumptions, however, are difficult or even impossible to verify using empirical data alone.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="r-packages-versions-and-dependencies" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> R packages, versions, and dependencies</h1>
<div class="cell-output-display">
<p>We used R version 4.3.0 <span class="citation" data-cites="base">(<a href="#ref-base" role="doc-biblioref">R Core Team 2023</a>)</span> and the following R packages: abind v. 1.4.5 <span class="citation" data-cites="abind">(<a href="#ref-abind" role="doc-biblioref">Plate and Heiberger 2016</a>)</span>, arrayhelpers v. 1.1.0 <span class="citation" data-cites="arrayhelpers">(<a href="#ref-arrayhelpers" role="doc-biblioref">Beleites 2020</a>)</span>, backports v. 1.4.1 <span class="citation" data-cites="backports">(<a href="#ref-backports" role="doc-biblioref">Lang and R Core Team 2021</a>)</span>, base64enc v. 0.1.3 <span class="citation" data-cites="base64enc">(<a href="#ref-base64enc" role="doc-biblioref">Urbanek 2015</a>)</span>, bayesplot v. 1.10.0 <span class="citation" data-cites="bayesplot2019 bayesplot2022">(<a href="#ref-bayesplot2019" role="doc-biblioref">Gabry et al. 2019</a>; <a href="#ref-bayesplot2022" role="doc-biblioref">Gabry and Mahr 2022</a>)</span>, BH v. 1.81.0.1 <span class="citation" data-cites="BH">(<a href="#ref-BH" role="doc-biblioref">Eddelbuettel, Emerson, and Kane 2023</a>)</span>, bridgesampling v. 1.1.2 <span class="citation" data-cites="bridgesampling">(<a href="#ref-bridgesampling" role="doc-biblioref">Gronau, Singmann, and Wagenmakers 2020</a>)</span>, brms v. 2.19.0 <span class="citation" data-cites="brms2017 brms2018 brms2021">(<a href="#ref-brms2017" role="doc-biblioref">Bürkner 2017</a>, <a href="#ref-brms2018" role="doc-biblioref">2018</a>, <a href="#ref-brms2021" role="doc-biblioref">2021</a>)</span>, Brobdingnag v. 1.2.9 <span class="citation" data-cites="Brobdingnag">(<a href="#ref-Brobdingnag" role="doc-biblioref">Hankin 2007</a>)</span>, bslib v. 0.5.0 <span class="citation" data-cites="bslib">(<a href="#ref-bslib" role="doc-biblioref">Sievert, Cheng, and Aden-Buie 2023</a>)</span>, cachem v. 1.0.8 <span class="citation" data-cites="cachem">(<a href="#ref-cachem" role="doc-biblioref">Chang 2023a</a>)</span>, callr v. 3.7.3 <span class="citation" data-cites="callr">(<a href="#ref-callr" role="doc-biblioref">Csárdi and Chang 2022</a>)</span>, checkmate v. 2.2.0 <span class="citation" data-cites="checkmate">(<a href="#ref-checkmate" role="doc-biblioref">Lang 2017</a>)</span>, cmdstanr v. 0.5.3 <span class="citation" data-cites="cmdstanr">(<a href="#ref-cmdstanr" role="doc-biblioref">Gabry and Češnovar 2022</a>)</span>, coda v. 0.19.4 <span class="citation" data-cites="coda">(<a href="#ref-coda" role="doc-biblioref">Plummer et al. 2006</a>)</span>, colorspace v. 2.1.0 <span class="citation" data-cites="colorspace2009b colorspace2009c colorspace2020a">(<a href="#ref-colorspace2009b" role="doc-biblioref">Zeileis, Hornik, and Murrell 2009</a>; <a href="#ref-colorspace2009c" role="doc-biblioref">Stauffer et al. 2009</a>; <a href="#ref-colorspace2020a" role="doc-biblioref">Zeileis et al. 2020</a>)</span>, colourpicker v. 1.2.0 <span class="citation" data-cites="colourpicker">(<a href="#ref-colourpicker" role="doc-biblioref">Attali 2022</a>)</span>, commonmark v. 1.9.0 <span class="citation" data-cites="commonmark">(<a href="#ref-commonmark" role="doc-biblioref">Ooms 2023</a>)</span>, cpp11 v. 0.4.3 <span class="citation" data-cites="cpp11">(<a href="#ref-cpp11" role="doc-biblioref">Hester and François 2022</a>)</span>, crayon v. 1.5.2 <span class="citation" data-cites="crayon">(<a href="#ref-crayon" role="doc-biblioref">Csárdi 2022</a>)</span>, crosstalk v. 1.2.0 <span class="citation" data-cites="crosstalk">(<a href="#ref-crosstalk" role="doc-biblioref">Cheng and Sievert 2021</a>)</span>, desc v. 1.4.2 <span class="citation" data-cites="desc">(<a href="#ref-desc" role="doc-biblioref">Csárdi, Müller, and Hester 2022</a>)</span>, digest v. 0.6.31 <span class="citation" data-cites="digest">(<a href="#ref-digest" role="doc-biblioref">Antoine Lucas et al. 2022</a>)</span>, distributional v. 0.3.2 <span class="citation" data-cites="distributional">(<a href="#ref-distributional" role="doc-biblioref">O’Hara-Wild, Kay, and Hayes 2023</a>)</span>, DT v. 0.28 <span class="citation" data-cites="DT">(<a href="#ref-DT" role="doc-biblioref">Xie, Cheng, and Tan 2023</a>)</span>, dygraphs v. 1.1.1.6 <span class="citation" data-cites="dygraphs">(<a href="#ref-dygraphs" role="doc-biblioref">Vanderkam et al. 2018</a>)</span>, ellipsis v. 0.3.2 <span class="citation" data-cites="ellipsis">(<a href="#ref-ellipsis" role="doc-biblioref">H. Wickham 2021</a>)</span>, evaluate v. 0.21 <span class="citation" data-cites="evaluate">(<a href="#ref-evaluate" role="doc-biblioref">H. Wickham and Xie 2023</a>)</span>, fansi v. 1.0.4 <span class="citation" data-cites="fansi">(<a href="#ref-fansi" role="doc-biblioref">Gaslam 2023</a>)</span>, farver v. 2.1.1 <span class="citation" data-cites="farver">(<a href="#ref-farver" role="doc-biblioref">Pedersen, Nicolae, and François 2022</a>)</span>, fastmap v. 1.1.1 <span class="citation" data-cites="fastmap">(<a href="#ref-fastmap" role="doc-biblioref">Chang 2023b</a>)</span>, fontawesome v. 0.5.1 <span class="citation" data-cites="fontawesome">(<a href="#ref-fontawesome" role="doc-biblioref">Iannone 2023</a>)</span>, fs v. 1.6.2 <span class="citation" data-cites="fs">(<a href="#ref-fs" role="doc-biblioref">Hester, Wickham, and Csárdi 2023</a>)</span>, future v. 1.32.0 [@], generics v. 0.1.3 <span class="citation" data-cites="generics">(<a href="#ref-generics" role="doc-biblioref">H. Wickham, Kuhn, and Vaughan 2022</a>)</span>, ggdist v. 3.3.0 <span class="citation" data-cites="ggdist">(<a href="#ref-ggdist" role="doc-biblioref">Kay 2023a</a>)</span>, ggridges v. 0.5.4 <span class="citation" data-cites="ggridges">(<a href="#ref-ggridges" role="doc-biblioref">Wilke 2022</a>)</span>, globals v. 0.16.2 <span class="citation" data-cites="globals">(<a href="#ref-globals" role="doc-biblioref">Bengtsson 2022a</a>)</span>, glue v. 1.6.2 <span class="citation" data-cites="glue">(<a href="#ref-glue" role="doc-biblioref">Hester and Bryan 2022</a>)</span>, gridExtra v. 2.3 <span class="citation" data-cites="gridExtra">(<a href="#ref-gridExtra" role="doc-biblioref">Auguie 2017</a>)</span>, gtable v. 0.3.3 <span class="citation" data-cites="gtable">(<a href="#ref-gtable" role="doc-biblioref">H. Wickham and Pedersen 2023</a>)</span>, gtools v. 3.9.4 <span class="citation" data-cites="gtools">(<a href="#ref-gtools" role="doc-biblioref">Bolker, Warnes, and Lumley 2022</a>)</span>, highr v. 0.10 <span class="citation" data-cites="highr">(<a href="#ref-highr" role="doc-biblioref">Xie and Qiu 2022</a>)</span>, htmltools v. 0.5.5 <span class="citation" data-cites="htmltools">(<a href="#ref-htmltools" role="doc-biblioref">Cheng, Sievert, et al. 2023</a>)</span>, htmlwidgets v. 1.6.2 <span class="citation" data-cites="htmlwidgets">(<a href="#ref-htmlwidgets" role="doc-biblioref">Vaidyanathan et al. 2023</a>)</span>, httpuv v. 1.6.11 <span class="citation" data-cites="httpuv">(<a href="#ref-httpuv" role="doc-biblioref">Cheng, Chang, et al. 2023</a>)</span>, igraph v. 1.4.3 <span class="citation" data-cites="igraph">(<a href="#ref-igraph" role="doc-biblioref">Csardi and Nepusz 2006</a>)</span>, inline v. 0.3.19 <span class="citation" data-cites="inline">(<a href="#ref-inline" role="doc-biblioref">Sklyar et al. 2021</a>)</span>, isoband v. 0.2.7 <span class="citation" data-cites="isoband">(<a href="#ref-isoband" role="doc-biblioref">H. Wickham, Wilke, and Pedersen 2022</a>)</span>, jquerylib v. 0.1.4 <span class="citation" data-cites="jquerylib">(<a href="#ref-jquerylib" role="doc-biblioref">Sievert and Cheng 2021</a>)</span>, knitr v. 1.43 <span class="citation" data-cites="knitr2014 knitr2015 knitr2023">(<a href="#ref-knitr2014" role="doc-biblioref">Xie 2014</a>, <a href="#ref-knitr2015" role="doc-biblioref">2015</a>, <a href="#ref-knitr2023" role="doc-biblioref">2023a</a>)</span>, labeling v. 0.4.2 <span class="citation" data-cites="labeling">(<a href="#ref-labeling" role="doc-biblioref">Justin Talbot 2020</a>)</span>, later v. 1.3.1 <span class="citation" data-cites="later">(<a href="#ref-later" role="doc-biblioref">Chang and Cheng 2023</a>)</span>, lazyeval v. 0.2.2 <span class="citation" data-cites="lazyeval">(<a href="#ref-lazyeval" role="doc-biblioref">H. Wickham 2019</a>)</span>, lifecycle v. 1.0.3 <span class="citation" data-cites="lifecycle">(<a href="#ref-lifecycle" role="doc-biblioref">Henry and Wickham 2022a</a>)</span>, listenv v. 0.9.0 <span class="citation" data-cites="listenv">(<a href="#ref-listenv" role="doc-biblioref">Bengtsson 2022b</a>)</span>, loo v. 2.6.0 <span class="citation" data-cites="loo2017b loo2017c loo2023a">(<a href="#ref-loo2017b" role="doc-biblioref">Vehtari, Gelman, and Gabry 2017</a>; <a href="#ref-loo2017c" role="doc-biblioref">Yao et al. 2017</a>; <a href="#ref-loo2023a" role="doc-biblioref">Vehtari et al. 2023</a>)</span>, markdown v. 1.7 <span class="citation" data-cites="markdown">(<a href="#ref-markdown" role="doc-biblioref">Xie, Allaire, and Horner 2023</a>)</span>, matrixStats v. 1.0.0 <span class="citation" data-cites="matrixStats">(<a href="#ref-matrixStats" role="doc-biblioref">Bengtsson 2023a</a>)</span>, memoise v. 2.0.1 <span class="citation" data-cites="memoise">(<a href="#ref-memoise" role="doc-biblioref">H. Wickham et al. 2021</a>)</span>, mime v. 0.12 <span class="citation" data-cites="mime">(<a href="#ref-mime" role="doc-biblioref">Xie 2021</a>)</span>, miniUI v. 0.1.1.1 <span class="citation" data-cites="miniUI">(<a href="#ref-miniUI" role="doc-biblioref">Cheng 2018</a>)</span>, munsell v. 0.5.0 <span class="citation" data-cites="munsell">(<a href="#ref-munsell" role="doc-biblioref">C. Wickham 2018</a>)</span>, mvtnorm v. 1.2.2 <span class="citation" data-cites="mvtnorm">(<a href="#ref-mvtnorm" role="doc-biblioref">Genz and Bretz 2009</a>)</span>, nleqslv v. 3.3.4 <span class="citation" data-cites="nleqslv">(<a href="#ref-nleqslv" role="doc-biblioref">Hasselman 2023</a>)</span>, numDeriv v. 2016.8.1.1 <span class="citation" data-cites="numDeriv">(<a href="#ref-numDeriv" role="doc-biblioref">Gilbert and Varadhan 2019</a>)</span>, parallelly v. 1.36.0 <span class="citation" data-cites="parallelly">(<a href="#ref-parallelly" role="doc-biblioref">Bengtsson 2023b</a>)</span>, patchwork v. 1.1.2 <span class="citation" data-cites="patchwork">(<a href="#ref-patchwork" role="doc-biblioref">Pedersen 2022</a>)</span>, pkgbuild v. 1.4.1 <span class="citation" data-cites="pkgbuild">(<a href="#ref-pkgbuild" role="doc-biblioref">H. Wickham, Hester, and Csárdi 2023</a>)</span>, pkgconfig v. 2.0.3 <span class="citation" data-cites="pkgconfig">(<a href="#ref-pkgconfig" role="doc-biblioref">Csárdi 2019</a>)</span>, plyr v. 1.8.8 <span class="citation" data-cites="plyr">(<a href="#ref-plyr" role="doc-biblioref">H. Wickham 2011</a>)</span>, posterior v. 1.4.1 <span class="citation" data-cites="posterior2021 posterior2023">(<a href="#ref-posterior2021" role="doc-biblioref">Vehtari et al. 2021</a>; <a href="#ref-posterior2023" role="doc-biblioref">Bürkner et al. 2023</a>)</span>, prettyunits v. 1.1.1 <span class="citation" data-cites="prettyunits">(<a href="#ref-prettyunits" role="doc-biblioref">Csardi 2020</a>)</span>, processx v. 3.8.1 <span class="citation" data-cites="processx">(<a href="#ref-processx" role="doc-biblioref">Csárdi and Chang 2023</a>)</span>, promises v. 1.2.0.1 <span class="citation" data-cites="promises">(<a href="#ref-promises" role="doc-biblioref">Cheng 2021</a>)</span>, ps v. 1.7.5 <span class="citation" data-cites="ps">(<a href="#ref-ps" role="doc-biblioref">Loden et al. 2023</a>)</span>, quadprog v. 1.5.8 <span class="citation" data-cites="quadprog">(<a href="#ref-quadprog" role="doc-biblioref">Berwin A. Turlach R port by Andreas Weingessel &lt;Andreas.Weingessel@ci.tuwien.ac.at&gt; Fortran contributions from Cleve Moler dpodi/LINPACK) 2019</a>)</span>, R6 v. 2.5.1 <span class="citation" data-cites="R6">(<a href="#ref-R6" role="doc-biblioref">Chang 2021a</a>)</span>, rappdirs v. 0.3.3 <span class="citation" data-cites="rappdirs">(<a href="#ref-rappdirs" role="doc-biblioref">Ratnakumar, Mick, and Davis 2021</a>)</span>, RColorBrewer v. 1.1.3 <span class="citation" data-cites="RColorBrewer">(<a href="#ref-RColorBrewer" role="doc-biblioref">Neuwirth 2022</a>)</span>, Rcpp v. 1.0.10 <span class="citation" data-cites="Rcpp2011 Rcpp2013 Rcpp2018">(<a href="#ref-Rcpp2011" role="doc-biblioref">Eddelbuettel and François 2011</a>; <a href="#ref-Rcpp2013" role="doc-biblioref">Eddelbuettel 2013</a>; <a href="#ref-Rcpp2018" role="doc-biblioref">Eddelbuettel and Balamuta 2018</a>)</span>, RcppEigen v. 0.3.3.9.3 <span class="citation" data-cites="RcppEigen">(<a href="#ref-RcppEigen" role="doc-biblioref">Bates and Eddelbuettel 2013</a>)</span>, RcppParallel v. 5.1.7 <span class="citation" data-cites="RcppParallel">(<a href="#ref-RcppParallel" role="doc-biblioref">Allaire, Francois, et al. 2023</a>)</span>, remotes v. 2.4.2 <span class="citation" data-cites="remotes">(<a href="#ref-remotes" role="doc-biblioref">Csárdi et al. 2021</a>)</span>, renv v. 1.0.0 <span class="citation" data-cites="renv">(<a href="#ref-renv" role="doc-biblioref">Ushey and Wickham 2023</a>)</span>, reshape2 v. 1.4.4 <span class="citation" data-cites="reshape2">(<a href="#ref-reshape2" role="doc-biblioref">H. Wickham 2007</a>)</span>, rmarkdown v. 2.22 <span class="citation" data-cites="rmarkdown2018 rmarkdown2020 rmarkdown2023">(<a href="#ref-rmarkdown2018" role="doc-biblioref">Xie, Allaire, and Grolemund 2018</a>; <a href="#ref-rmarkdown2020" role="doc-biblioref">Xie, Dervieux, and Riederer 2020</a>; <a href="#ref-rmarkdown2023" role="doc-biblioref">Allaire, Xie, et al. 2023</a>)</span>, rprojroot v. 2.0.3 <span class="citation" data-cites="rprojroot">(<a href="#ref-rprojroot" role="doc-biblioref">Müller 2022</a>)</span>, rstan v. 2.21.8 <span class="citation" data-cites="rstan">(<a href="#ref-rstan" role="doc-biblioref">Stan Development Team 2023</a>)</span>, rstantools v. 2.3.1 <span class="citation" data-cites="rstantools">(<a href="#ref-rstantools" role="doc-biblioref">Gabry et al. 2023</a>)</span>, sass v. 0.4.6 <span class="citation" data-cites="sass">(<a href="#ref-sass" role="doc-biblioref">Cheng, Mastny, et al. 2023</a>)</span>, scales v. 1.2.1 <span class="citation" data-cites="scales">(<a href="#ref-scales" role="doc-biblioref">H. Wickham and Seidel 2022</a>)</span>, shiny v. 1.7.4 <span class="citation" data-cites="shiny">(<a href="#ref-shiny" role="doc-biblioref">Chang et al. 2022</a>)</span>, shinyjs v. 2.1.0 <span class="citation" data-cites="shinyjs">(<a href="#ref-shinyjs" role="doc-biblioref">Attali 2021</a>)</span>, shinystan v. 2.6.0 <span class="citation" data-cites="shinystan">(<a href="#ref-shinystan" role="doc-biblioref">Gabry and Veen 2022</a>)</span>, shinythemes v. 1.2.0 <span class="citation" data-cites="shinythemes">(<a href="#ref-shinythemes" role="doc-biblioref">Chang 2021b</a>)</span>, sourcetools v. 0.1.7.1 <span class="citation" data-cites="sourcetools">(<a href="#ref-sourcetools" role="doc-biblioref">Ushey 2023</a>)</span>, StanHeaders v. 2.26.27 <span class="citation" data-cites="StanHeaders">(<a href="#ref-StanHeaders" role="doc-biblioref">Stan Development Team 2020</a>)</span>, stringi v. 1.7.12 <span class="citation" data-cites="stringi">(<a href="#ref-stringi" role="doc-biblioref">Gagolewski 2022</a>)</span>, svUnit v. 1.0.6 <span class="citation" data-cites="svUnit">(<a href="#ref-svUnit" role="doc-biblioref">Grosjean 2023</a>)</span>, tensorA v. 0.36.2 <span class="citation" data-cites="tensorA">(<a href="#ref-tensorA" role="doc-biblioref">van den Boogaart 2020</a>)</span>, threejs v. 0.3.3 <span class="citation" data-cites="threejs">(<a href="#ref-threejs" role="doc-biblioref">Lewis 2020</a>)</span>, tidybayes v. 3.0.4 <span class="citation" data-cites="tidybayes">(<a href="#ref-tidybayes" role="doc-biblioref">Kay 2023b</a>)</span>, tidyselect v. 1.2.0 <span class="citation" data-cites="tidyselect">(<a href="#ref-tidyselect" role="doc-biblioref">Henry and Wickham 2022b</a>)</span>, tidyverse v. 2.0.0 <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">H. Wickham et al. 2019</a>)</span>, tinytex v. 0.45 <span class="citation" data-cites="tinytex2019 tinytex2023">(<a href="#ref-tinytex2019" role="doc-biblioref">Xie 2019</a>, <a href="#ref-tinytex2023" role="doc-biblioref">2023b</a>)</span>, utf8 v. 1.2.3 <span class="citation" data-cites="utf8">(<a href="#ref-utf8" role="doc-biblioref">Perry 2023</a>)</span>, vctrs v. 0.6.2 <span class="citation" data-cites="vctrs">(<a href="#ref-vctrs" role="doc-biblioref">H. Wickham, Henry, and Vaughan 2023</a>)</span>, viridis v. 0.6.3 <span class="citation" data-cites="viridis">(<a href="#ref-viridis" role="doc-biblioref">Garnier et al. 2023a</a>)</span>, viridisLite v. 0.4.2 <span class="citation" data-cites="viridisLite">(<a href="#ref-viridisLite" role="doc-biblioref">Garnier et al. 2023b</a>)</span>, withr v. 2.5.0 <span class="citation" data-cites="withr">(<a href="#ref-withr" role="doc-biblioref">Hester et al. 2022</a>)</span>, xfun v. 0.39 <span class="citation" data-cites="xfun">(<a href="#ref-xfun" role="doc-biblioref">Xie 2023c</a>)</span>, xtable v. 1.8.4 <span class="citation" data-cites="xtable">(<a href="#ref-xtable" role="doc-biblioref">Dahl et al. 2019</a>)</span>, xts v. 0.13.1 <span class="citation" data-cites="xts">(<a href="#ref-xts" role="doc-biblioref">Ryan and Ulrich 2023</a>)</span>, yaml v. 2.3.7 <span class="citation" data-cites="yaml">(<a href="#ref-yaml" role="doc-biblioref">Garbett et al. 2023</a>)</span>, zoo v. 1.8.12 <span class="citation" data-cites="zoo">(<a href="#ref-zoo" role="doc-biblioref">Zeileis and Grothendieck 2005</a>)</span>.</p>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="references" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-RcppParallel" class="csl-entry" role="doc-biblioentry">
Allaire, JJ, Romain Francois, Kevin Ushey, Gregory Vandenbrouck, Marcus Geelnard, and Intel. 2023. <em><span>RcppParallel</span>: Parallel Programming Tools for <span>“<span>Rcpp</span>”</span></em>. <a href="https://CRAN.R-project.org/package=RcppParallel">https://CRAN.R-project.org/package=RcppParallel</a>.
</div>
<div id="ref-rmarkdown2023" class="csl-entry" role="doc-biblioentry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, et al. 2023. <em><span class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-digest" class="csl-entry" role="doc-biblioentry">
Antoine Lucas, Dirk Eddelbuettel with contributions by, Jarek Tuszynski, Henrik Bengtsson, Simon Urbanek, Mario Frasca, Bryan Lewis, Murray Stokely, et al. 2022. <em><span class="nocase">digest</span>: Create Compact Hash Digests of r Objects</em>. <a href="https://CRAN.R-project.org/package=digest">https://CRAN.R-project.org/package=digest</a>.
</div>
<div id="ref-shinyjs" class="csl-entry" role="doc-biblioentry">
Attali, Dean. 2021. <em><span class="nocase">shinyjs</span>: Easily Improve the User Experience of Your Shiny Apps in Seconds</em>. <a href="https://CRAN.R-project.org/package=shinyjs">https://CRAN.R-project.org/package=shinyjs</a>.
</div>
<div id="ref-colourpicker" class="csl-entry" role="doc-biblioentry">
———. 2022. <em><span class="nocase">colourpicker</span>: A Colour Picker Tool for Shiny and for Selecting Colours in Plots</em>. <a href="https://CRAN.R-project.org/package=colourpicker">https://CRAN.R-project.org/package=colourpicker</a>.
</div>
<div id="ref-gridExtra" class="csl-entry" role="doc-biblioentry">
Auguie, Baptiste. 2017. <em><span class="nocase">gridExtra</span>: Miscellaneous Functions for <span>“<span>Grid</span>”</span> Graphics</em>. <a href="https://CRAN.R-project.org/package=gridExtra">https://CRAN.R-project.org/package=gridExtra</a>.
</div>
<div id="ref-RcppEigen" class="csl-entry" role="doc-biblioentry">
Bates, Douglas, and Dirk Eddelbuettel. 2013. <span>“Fast and Elegant Numerical Linear Algebra Using the <span>RcppEigen</span> Package.”</span> <em>Journal of Statistical Software</em> 52 (5): 1–24. <a href="https://doi.org/10.18637/jss.v052.i05">https://doi.org/10.18637/jss.v052.i05</a>.
</div>
<div id="ref-arrayhelpers" class="csl-entry" role="doc-biblioentry">
Beleites, C. 2020. <em><span class="nocase">arrayhelpers</span>: Convenience Functions for Arrays</em>. <a href="https://CRAN.R-project.org/package=arrayhelpers">https://CRAN.R-project.org/package=arrayhelpers</a>.
</div>
<div id="ref-globals" class="csl-entry" role="doc-biblioentry">
Bengtsson, Henrik. 2022a. <em><span class="nocase">globals</span>: Identify Global Objects in r Expressions</em>. <a href="https://CRAN.R-project.org/package=globals">https://CRAN.R-project.org/package=globals</a>.
</div>
<div id="ref-listenv" class="csl-entry" role="doc-biblioentry">
———. 2022b. <em><span class="nocase">listenv</span>: Environments Behaving (Almost) as Lists</em>. <a href="https://CRAN.R-project.org/package=listenv">https://CRAN.R-project.org/package=listenv</a>.
</div>
<div id="ref-matrixStats" class="csl-entry" role="doc-biblioentry">
———. 2023a. <em><span class="nocase">matrixStats</span>: Functions That Apply to Rows and Columns of Matrices (and to Vectors)</em>. <a href="https://CRAN.R-project.org/package=matrixStats">https://CRAN.R-project.org/package=matrixStats</a>.
</div>
<div id="ref-parallelly" class="csl-entry" role="doc-biblioentry">
———. 2023b. <em><span class="nocase">parallelly</span>: Enhancing the <span>“<span class="nocase">parallel</span>”</span> Package</em>. <a href="https://CRAN.R-project.org/package=parallelly">https://CRAN.R-project.org/package=parallelly</a>.
</div>
<div id="ref-quadprog" class="csl-entry" role="doc-biblioentry">
Berwin A. Turlach R port by Andreas Weingessel &lt;Andreas.Weingessel@ci.tuwien.ac.at&gt; Fortran contributions from Cleve Moler dpodi/LINPACK), S original by. 2019. <em><span class="nocase">quadprog</span>: Functions to Solve Quadratic Programming Problems</em>. <a href="https://CRAN.R-project.org/package=quadprog">https://CRAN.R-project.org/package=quadprog</a>.
</div>
<div id="ref-gtools" class="csl-entry" role="doc-biblioentry">
Bolker, Ben, Gregory R. Warnes, and Thomas Lumley. 2022. <em><span class="nocase">gtools</span>: Various r Programming Tools</em>. <a href="https://CRAN.R-project.org/package=gtools">https://CRAN.R-project.org/package=gtools</a>.
</div>
<div id="ref-brms2017" class="csl-entry" role="doc-biblioentry">
Bürkner, Paul-Christian. 2017. <span>“<span class="nocase">brms</span>: An <span>R</span> Package for <span>Bayesian</span> Multilevel Models Using <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 80 (1): 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-brms2018" class="csl-entry" role="doc-biblioentry">
———. 2018. <span>“Advanced <span>Bayesian</span> Multilevel Modeling with the <span>R</span> Package <span class="nocase">brms</span>.”</span> <em>The R Journal</em> 10 (1): 395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>.
</div>
<div id="ref-brms2021" class="csl-entry" role="doc-biblioentry">
———. 2021. <span>“Bayesian Item Response Modeling in <span>R</span> with <span class="nocase">brms</span> and <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 100 (5): 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>.
</div>
<div id="ref-posterior2023" class="csl-entry" role="doc-biblioentry">
Bürkner, Paul-Christian, Jonah Gabry, Matthew Kay, and Aki Vehtari. 2023. <span>“<span class="nocase">posterior</span>: Tools for Working with Posterior Distributions.”</span> <a href="https://mc-stan.org/posterior/">https://mc-stan.org/posterior/</a>.
</div>
<div id="ref-R6" class="csl-entry" role="doc-biblioentry">
Chang, Winston. 2021a. <em>R6: Encapsulated Classes with Reference Semantics</em>. <a href="https://CRAN.R-project.org/package=R6">https://CRAN.R-project.org/package=R6</a>.
</div>
<div id="ref-shinythemes" class="csl-entry" role="doc-biblioentry">
———. 2021b. <em><span class="nocase">shinythemes</span>: Themes for Shiny</em>. <a href="https://CRAN.R-project.org/package=shinythemes">https://CRAN.R-project.org/package=shinythemes</a>.
</div>
<div id="ref-cachem" class="csl-entry" role="doc-biblioentry">
———. 2023a. <em><span class="nocase">cachem</span>: Cache r Objects with Automatic Pruning</em>. <a href="https://CRAN.R-project.org/package=cachem">https://CRAN.R-project.org/package=cachem</a>.
</div>
<div id="ref-fastmap" class="csl-entry" role="doc-biblioentry">
———. 2023b. <em><span class="nocase">fastmap</span>: Fast Data Structures</em>. <a href="https://CRAN.R-project.org/package=fastmap">https://CRAN.R-project.org/package=fastmap</a>.
</div>
<div id="ref-later" class="csl-entry" role="doc-biblioentry">
Chang, Winston, and Joe Cheng. 2023. <em><span class="nocase">later</span>: Utilities for Scheduling Functions to Execute Later with Event Loops</em>. <a href="https://CRAN.R-project.org/package=later">https://CRAN.R-project.org/package=later</a>.
</div>
<div id="ref-shiny" class="csl-entry" role="doc-biblioentry">
Chang, Winston, Joe Cheng, JJ Allaire, Carson Sievert, Barret Schloerke, Yihui Xie, Jeff Allen, Jonathan McPherson, Alan Dipert, and Barbara Borges. 2022. <em><span class="nocase">shiny</span>: Web Application Framework for r</em>. <a href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>.
</div>
<div id="ref-miniUI" class="csl-entry" role="doc-biblioentry">
Cheng, Joe. 2018. <em><span class="nocase">miniUI</span>: Shiny UI Widgets for Small Screens</em>. <a href="https://CRAN.R-project.org/package=miniUI">https://CRAN.R-project.org/package=miniUI</a>.
</div>
<div id="ref-promises" class="csl-entry" role="doc-biblioentry">
———. 2021. <em><span class="nocase">promises</span>: Abstractions for Promise-Based Asynchronous Programming</em>. <a href="https://CRAN.R-project.org/package=promises">https://CRAN.R-project.org/package=promises</a>.
</div>
<div id="ref-httpuv" class="csl-entry" role="doc-biblioentry">
Cheng, Joe, Winston Chang, Steve Reid, James Brown, Bob Trower, and Alexander Peslyak. 2023. <em><span class="nocase">httpuv</span>: HTTP and WebSocket Server Library</em>. <a href="https://CRAN.R-project.org/package=httpuv">https://CRAN.R-project.org/package=httpuv</a>.
</div>
<div id="ref-sass" class="csl-entry" role="doc-biblioentry">
Cheng, Joe, Timothy Mastny, Richard Iannone, Barret Schloerke, and Carson Sievert. 2023. <em><span class="nocase">sass</span>: Syntactically Awesome Style Sheets (<span>“<span>Sass</span>”</span>)</em>. <a href="https://CRAN.R-project.org/package=sass">https://CRAN.R-project.org/package=sass</a>.
</div>
<div id="ref-crosstalk" class="csl-entry" role="doc-biblioentry">
Cheng, Joe, and Carson Sievert. 2021. <em><span class="nocase">crosstalk</span>: Inter-Widget Interactivity for HTML Widgets</em>. <a href="https://CRAN.R-project.org/package=crosstalk">https://CRAN.R-project.org/package=crosstalk</a>.
</div>
<div id="ref-htmltools" class="csl-entry" role="doc-biblioentry">
Cheng, Joe, Carson Sievert, Barret Schloerke, Winston Chang, Yihui Xie, and Jeff Allen. 2023. <em><span class="nocase">htmltools</span>: Tools for HTML</em>. <a href="https://CRAN.R-project.org/package=htmltools">https://CRAN.R-project.org/package=htmltools</a>.
</div>
<div id="ref-prettyunits" class="csl-entry" role="doc-biblioentry">
Csardi, Gabor. 2020. <em><span class="nocase">prettyunits</span>: Pretty, Human Readable Formatting of Quantities</em>. <a href="https://CRAN.R-project.org/package=prettyunits">https://CRAN.R-project.org/package=prettyunits</a>.
</div>
<div id="ref-igraph" class="csl-entry" role="doc-biblioentry">
Csardi, Gabor, and Tamas Nepusz. 2006. <span>“The Igraph Software Package for Complex Network Research.”</span> <em>InterJournal</em> Complex Systems: 1695. <a href="https://igraph.org">https://igraph.org</a>.
</div>
<div id="ref-pkgconfig" class="csl-entry" role="doc-biblioentry">
Csárdi, Gábor. 2019. <em><span class="nocase">pkgconfig</span>: Private Configuration for <span>“<span>R</span>”</span> Packages</em>. <a href="https://CRAN.R-project.org/package=pkgconfig">https://CRAN.R-project.org/package=pkgconfig</a>.
</div>
<div id="ref-crayon" class="csl-entry" role="doc-biblioentry">
———. 2022. <em><span class="nocase">crayon</span>: Colored Terminal Output</em>. <a href="https://CRAN.R-project.org/package=crayon">https://CRAN.R-project.org/package=crayon</a>.
</div>
<div id="ref-callr" class="csl-entry" role="doc-biblioentry">
Csárdi, Gábor, and Winston Chang. 2022. <em><span class="nocase">callr</span>: Call r from r</em>. <a href="https://CRAN.R-project.org/package=callr">https://CRAN.R-project.org/package=callr</a>.
</div>
<div id="ref-processx" class="csl-entry" role="doc-biblioentry">
———. 2023. <em><span class="nocase">processx</span>: Execute and Control System Processes</em>. <a href="https://CRAN.R-project.org/package=processx">https://CRAN.R-project.org/package=processx</a>.
</div>
<div id="ref-remotes" class="csl-entry" role="doc-biblioentry">
Csárdi, Gábor, Jim Hester, Hadley Wickham, Winston Chang, Martin Morgan, and Dan Tenenbaum. 2021. <em><span class="nocase">remotes</span>: R Package Installation from Remote Repositories, Including <span>“<span>GitHub</span>”</span></em>. <a href="https://CRAN.R-project.org/package=remotes">https://CRAN.R-project.org/package=remotes</a>.
</div>
<div id="ref-desc" class="csl-entry" role="doc-biblioentry">
Csárdi, Gábor, Kirill Müller, and Jim Hester. 2022. <em><span class="nocase">desc</span>: Manipulate DESCRIPTION Files</em>. <a href="https://CRAN.R-project.org/package=desc">https://CRAN.R-project.org/package=desc</a>.
</div>
<div id="ref-xtable" class="csl-entry" role="doc-biblioentry">
Dahl, David B., David Scott, Charles Roosen, Arni Magnusson, and Jonathan Swinton. 2019. <em><span class="nocase">xtable</span>: Export Tables to LaTeX or HTML</em>. <a href="https://CRAN.R-project.org/package=xtable">https://CRAN.R-project.org/package=xtable</a>.
</div>
<div id="ref-Rcpp2013" class="csl-entry" role="doc-biblioentry">
Eddelbuettel, Dirk. 2013. <em>Seamless <span>R</span> and <span>C++</span> Integration with <span>Rcpp</span></em>. New York: Springer. <a href="https://doi.org/10.1007/978-1-4614-6868-4">https://doi.org/10.1007/978-1-4614-6868-4</a>.
</div>
<div id="ref-Rcpp2018" class="csl-entry" role="doc-biblioentry">
Eddelbuettel, Dirk, and James Joseph Balamuta. 2018. <span>“<span class="nocase">Extending extit<span>R</span> with extit<span>C++</span>: A Brief Introduction to extit<span>Rcpp</span></span>.”</span> <em>The American Statistician</em> 72 (1): 28–36. <a href="https://doi.org/10.1080/00031305.2017.1375990">https://doi.org/10.1080/00031305.2017.1375990</a>.
</div>
<div id="ref-BH" class="csl-entry" role="doc-biblioentry">
Eddelbuettel, Dirk, John W. Emerson, and Michael J. Kane. 2023. <em><span>BH</span>: Boost c++ Header Files</em>. <a href="https://CRAN.R-project.org/package=BH">https://CRAN.R-project.org/package=BH</a>.
</div>
<div id="ref-Rcpp2011" class="csl-entry" role="doc-biblioentry">
Eddelbuettel, Dirk, and Romain François. 2011. <span>“<span>Rcpp</span>: Seamless <span>R</span> and <span>C++</span> Integration.”</span> <em>Journal of Statistical Software</em> 40 (8): 1–18. <a href="https://doi.org/10.18637/jss.v040.i08">https://doi.org/10.18637/jss.v040.i08</a>.
</div>
<div id="ref-cmdstanr" class="csl-entry" role="doc-biblioentry">
Gabry, Jonah, and Rok Češnovar. 2022. <em><span class="nocase">cmdstanr</span>: R Interface to <span>“<span>CmdStan</span>”</span></em>.
</div>
<div id="ref-rstantools" class="csl-entry" role="doc-biblioentry">
Gabry, Jonah, Ben Goodrich, Martin Lysy, and Andrew Johnson. 2023. <em><span class="nocase">rstantools</span>: Tools for Developing r Packages Interfacing with <span>“<span>Stan</span>”</span></em>. <a href="https://CRAN.R-project.org/package=rstantools">https://CRAN.R-project.org/package=rstantools</a>.
</div>
<div id="ref-bayesplot2022" class="csl-entry" role="doc-biblioentry">
Gabry, Jonah, and Tristan Mahr. 2022. <span>“<span class="nocase">bayesplot</span>: Plotting for Bayesian Models.”</span> <a href="https://mc-stan.org/bayesplot/">https://mc-stan.org/bayesplot/</a>.
</div>
<div id="ref-bayesplot2019" class="csl-entry" role="doc-biblioentry">
Gabry, Jonah, Daniel Simpson, Aki Vehtari, Michael Betancourt, and Andrew Gelman. 2019. <span>“Visualization in Bayesian Workflow.”</span> <em>J. R. Stat. Soc. A</em> 182: 389–402. <a href="https://doi.org/10.1111/rssa.12378">https://doi.org/10.1111/rssa.12378</a>.
</div>
<div id="ref-shinystan" class="csl-entry" role="doc-biblioentry">
Gabry, Jonah, and Duco Veen. 2022. <em><span class="nocase">shinystan</span>: Interactive Visual and Numerical Diagnostics and Posterior Analysis for Bayesian Models</em>. <a href="https://CRAN.R-project.org/package=shinystan">https://CRAN.R-project.org/package=shinystan</a>.
</div>
<div id="ref-stringi" class="csl-entry" role="doc-biblioentry">
Gagolewski, Marek. 2022. <span>“<span class="nocase">stringi</span>: <span>F</span>ast and Portable Character String Processing in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 103 (2): 1–59. <a href="https://doi.org/10.18637/jss.v103.i02">https://doi.org/10.18637/jss.v103.i02</a>.
</div>
<div id="ref-yaml" class="csl-entry" role="doc-biblioentry">
Garbett, Shawn P, Jeremy Stephens, Kirill Simonov, Yihui Xie, Zhuoer Dong, Hadley Wickham, Jeffrey Horner, et al. 2023. <em><span class="nocase">yaml</span>: Methods to Convert r Data to YAML and Back</em>. <a href="https://CRAN.R-project.org/package=yaml">https://CRAN.R-project.org/package=yaml</a>.
</div>
<div id="ref-viridis" class="csl-entry" role="doc-biblioentry">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2023a. <em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly Color Maps for r</em>. <a href="https://doi.org/10.5281/zenodo.4679424">https://doi.org/10.5281/zenodo.4679424</a>.
</div>
<div id="ref-viridisLite" class="csl-entry" role="doc-biblioentry">
———, et al. 2023b. <em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly Color Maps for r</em>. <a href="https://doi.org/10.5281/zenodo.4678327">https://doi.org/10.5281/zenodo.4678327</a>.
</div>
<div id="ref-fansi" class="csl-entry" role="doc-biblioentry">
Gaslam, Brodie. 2023. <em><span class="nocase">fansi</span>: ANSI Control Sequence Aware String Functions</em>. <a href="https://CRAN.R-project.org/package=fansi">https://CRAN.R-project.org/package=fansi</a>.
</div>
<div id="ref-mvtnorm" class="csl-entry" role="doc-biblioentry">
Genz, Alan, and Frank Bretz. 2009. <em>Computation of Multivariate Normal and t Probabilities</em>. Lecture Notes in Statistics. Heidelberg: Springer-Verlag.
</div>
<div id="ref-numDeriv" class="csl-entry" role="doc-biblioentry">
Gilbert, Paul, and Ravi Varadhan. 2019. <em><span class="nocase">numDeriv</span>: Accurate Numerical Derivatives</em>. <a href="https://CRAN.R-project.org/package=numDeriv">https://CRAN.R-project.org/package=numDeriv</a>.
</div>
<div id="ref-bridgesampling" class="csl-entry" role="doc-biblioentry">
Gronau, Quentin F., Henrik Singmann, and Eric-Jan Wagenmakers. 2020. <span>“<span class="nocase">bridgesampling</span>: An <span>R</span> Package for Estimating Normalizing Constants.”</span> <em>Journal of Statistical Software</em> 92 (10): 1–29. <a href="https://doi.org/10.18637/jss.v092.i10">https://doi.org/10.18637/jss.v092.i10</a>.
</div>
<div id="ref-svUnit" class="csl-entry" role="doc-biblioentry">
Grosjean, Philippe. 2023. <em>SciViews-r</em>. MONS, Belgium: UMONS. <a href="https://www.sciviews.org/SciViews-R/">https://www.sciviews.org/SciViews-R/</a>.
</div>
<div id="ref-Brobdingnag" class="csl-entry" role="doc-biblioentry">
Hankin, R. K. S. 2007. <span>“Very Large Numbers in r: Introducing Package Brobdingnag.”</span> <em>R News</em> 7.
</div>
<div id="ref-nleqslv" class="csl-entry" role="doc-biblioentry">
Hasselman, Berend. 2023. <em><span class="nocase">nleqslv</span>: Solve Systems of Nonlinear Equations</em>. <a href="https://CRAN.R-project.org/package=nleqslv">https://CRAN.R-project.org/package=nleqslv</a>.
</div>
<div id="ref-lifecycle" class="csl-entry" role="doc-biblioentry">
Henry, Lionel, and Hadley Wickham. 2022a. <em><span class="nocase">lifecycle</span>: Manage the Life Cycle of Your Package Functions</em>. <a href="https://CRAN.R-project.org/package=lifecycle">https://CRAN.R-project.org/package=lifecycle</a>.
</div>
<div id="ref-tidyselect" class="csl-entry" role="doc-biblioentry">
———. 2022b. <em><span class="nocase">tidyselect</span>: Select from a Set of Strings</em>. <a href="https://CRAN.R-project.org/package=tidyselect">https://CRAN.R-project.org/package=tidyselect</a>.
</div>
<div id="ref-glue" class="csl-entry" role="doc-biblioentry">
Hester, Jim, and Jennifer Bryan. 2022. <em><span class="nocase">glue</span>: Interpreted String Literals</em>. <a href="https://CRAN.R-project.org/package=glue">https://CRAN.R-project.org/package=glue</a>.
</div>
<div id="ref-cpp11" class="csl-entry" role="doc-biblioentry">
Hester, Jim, and Romain François. 2022. <em>Cpp11: A c++11 Interface for r’s c Interface</em>. <a href="https://CRAN.R-project.org/package=cpp11">https://CRAN.R-project.org/package=cpp11</a>.
</div>
<div id="ref-withr" class="csl-entry" role="doc-biblioentry">
Hester, Jim, Lionel Henry, Kirill Müller, Kevin Ushey, Hadley Wickham, and Winston Chang. 2022. <em><span class="nocase">withr</span>: Run Code <span>“<span>With</span>”</span> Temporarily Modified Global State</em>. <a href="https://CRAN.R-project.org/package=withr">https://CRAN.R-project.org/package=withr</a>.
</div>
<div id="ref-fs" class="csl-entry" role="doc-biblioentry">
Hester, Jim, Hadley Wickham, and Gábor Csárdi. 2023. <em><span class="nocase">fs</span>: Cross-Platform File System Operations Based on <span>“<span class="nocase">libuv</span>”</span></em>. <a href="https://CRAN.R-project.org/package=fs">https://CRAN.R-project.org/package=fs</a>.
</div>
<div id="ref-fontawesome" class="csl-entry" role="doc-biblioentry">
Iannone, Richard. 2023. <em><span class="nocase">fontawesome</span>: Easily Work with <span>“<span>Font Awesome</span>”</span> Icons</em>. <a href="https://CRAN.R-project.org/package=fontawesome">https://CRAN.R-project.org/package=fontawesome</a>.
</div>
<div id="ref-labeling" class="csl-entry" role="doc-biblioentry">
Justin Talbot. 2020. <em><span class="nocase">labeling</span>: Axis Labeling</em>. <a href="https://CRAN.R-project.org/package=labeling">https://CRAN.R-project.org/package=labeling</a>.
</div>
<div id="ref-ggdist" class="csl-entry" role="doc-biblioentry">
Kay, Matthew. 2023a. <em><span class="nocase">ggdist</span>: Visualizations of Distributions and Uncertainty</em>. <a href="https://doi.org/10.5281/zenodo.3879620">https://doi.org/10.5281/zenodo.3879620</a>.
</div>
<div id="ref-tidybayes" class="csl-entry" role="doc-biblioentry">
———. 2023b. <em><span class="nocase">tidybayes</span>: Tidy Data and Geoms for <span>Bayesian</span> Models</em>. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>.
</div>
<div id="ref-checkmate" class="csl-entry" role="doc-biblioentry">
Lang, Michel. 2017. <span>“<span class="nocase">checkmate</span>: Fast Argument Checks for Defensive <span>R</span> Programming.”</span> <em>The R Journal</em> 9 (1): 437–45. <a href="https://doi.org/10.32614/RJ-2017-028">https://doi.org/10.32614/RJ-2017-028</a>.
</div>
<div id="ref-backports" class="csl-entry" role="doc-biblioentry">
Lang, Michel, and R Core Team. 2021. <em><span class="nocase">backports</span>: Reimplementations of Functions Introduced Since r-3.0.0</em>. <a href="https://CRAN.R-project.org/package=backports">https://CRAN.R-project.org/package=backports</a>.
</div>
<div id="ref-threejs" class="csl-entry" role="doc-biblioentry">
Lewis, B. W. 2020. <em><span class="nocase">threejs</span>: Interactive 3D Scatter Plots, Networks and Globes</em>. <a href="https://CRAN.R-project.org/package=threejs">https://CRAN.R-project.org/package=threejs</a>.
</div>
<div id="ref-ps" class="csl-entry" role="doc-biblioentry">
Loden, Jay, Dave Daeschler, Giampaolo Rodola’, and Gábor Csárdi. 2023. <em><span class="nocase">ps</span>: List, Query, Manipulate System Processes</em>. <a href="https://CRAN.R-project.org/package=ps">https://CRAN.R-project.org/package=ps</a>.
</div>
<div id="ref-rprojroot" class="csl-entry" role="doc-biblioentry">
Müller, Kirill. 2022. <em><span class="nocase">rprojroot</span>: Finding Files in Project Subdirectories</em>. <a href="https://CRAN.R-project.org/package=rprojroot">https://CRAN.R-project.org/package=rprojroot</a>.
</div>
<div id="ref-RColorBrewer" class="csl-entry" role="doc-biblioentry">
Neuwirth, Erich. 2022. <em><span>RColorBrewer</span>: ColorBrewer Palettes</em>. <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>.
</div>
<div id="ref-distributional" class="csl-entry" role="doc-biblioentry">
O’Hara-Wild, Mitchell, Matthew Kay, and Alex Hayes. 2023. <em><span class="nocase">distributional</span>: Vectorised Probability Distributions</em>. <a href="https://CRAN.R-project.org/package=distributional">https://CRAN.R-project.org/package=distributional</a>.
</div>
<div id="ref-commonmark" class="csl-entry" role="doc-biblioentry">
Ooms, Jeroen. 2023. <em><span class="nocase">commonmark</span>: High Performance CommonMark and Github Markdown Rendering in r</em>. <a href="https://CRAN.R-project.org/package=commonmark">https://CRAN.R-project.org/package=commonmark</a>.
</div>
<div id="ref-patchwork" class="csl-entry" role="doc-biblioentry">
Pedersen, Thomas Lin. 2022. <em><span class="nocase">patchwork</span>: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-farver" class="csl-entry" role="doc-biblioentry">
Pedersen, Thomas Lin, Berendea Nicolae, and Romain François. 2022. <em><span class="nocase">farver</span>: High Performance Colour Space Manipulation</em>. <a href="https://CRAN.R-project.org/package=farver">https://CRAN.R-project.org/package=farver</a>.
</div>
<div id="ref-utf8" class="csl-entry" role="doc-biblioentry">
Perry, Patrick O. 2023. <em>Utf8: Unicode Text Processing</em>. <a href="https://CRAN.R-project.org/package=utf8">https://CRAN.R-project.org/package=utf8</a>.
</div>
<div id="ref-abind" class="csl-entry" role="doc-biblioentry">
Plate, Tony, and Richard Heiberger. 2016. <em><span class="nocase">abind</span>: Combine Multidimensional Arrays</em>. <a href="https://CRAN.R-project.org/package=abind">https://CRAN.R-project.org/package=abind</a>.
</div>
<div id="ref-coda" class="csl-entry" role="doc-biblioentry">
Plummer, Martyn, Nicky Best, Kate Cowles, and Karen Vines. 2006. <span>“<span>CODA</span>: Convergence Diagnosis and Output Analysis for MCMC.”</span> <em>R News</em> 6 (1): 7–11. <a href="https://journal.r-project.org/archive/">https://journal.r-project.org/archive/</a>.
</div>
<div id="ref-base" class="csl-entry" role="doc-biblioentry">
R Core Team. 2023. <em><span>R</span>: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-rappdirs" class="csl-entry" role="doc-biblioentry">
Ratnakumar, Sridhar, Trent Mick, and Trevor Davis. 2021. <em><span class="nocase">rappdirs</span>: Application Directories: Determine Where to Save Data, Caches, and Logs</em>. <a href="https://CRAN.R-project.org/package=rappdirs">https://CRAN.R-project.org/package=rappdirs</a>.
</div>
<div id="ref-xts" class="csl-entry" role="doc-biblioentry">
Ryan, Jeffrey A., and Joshua M. Ulrich. 2023. <em><span class="nocase">xts</span>: eXtensible Time Series</em>. <a href="https://CRAN.R-project.org/package=xts">https://CRAN.R-project.org/package=xts</a>.
</div>
<div id="ref-jquerylib" class="csl-entry" role="doc-biblioentry">
Sievert, Carson, and Joe Cheng. 2021. <em><span class="nocase">jquerylib</span>: Obtain <span>“<span class="nocase">jQuery</span>”</span> as an HTML Dependency Object</em>. <a href="https://CRAN.R-project.org/package=jquerylib">https://CRAN.R-project.org/package=jquerylib</a>.
</div>
<div id="ref-bslib" class="csl-entry" role="doc-biblioentry">
Sievert, Carson, Joe Cheng, and Garrick Aden-Buie. 2023. <em><span class="nocase">bslib</span>: Custom <span>“<span>Bootstrap</span>”</span> <span>“<span>Sass</span>”</span> Themes for <span>“<span class="nocase">shiny</span>”</span> and <span>“<span class="nocase">rmarkdown</span>”</span></em>. <a href="https://CRAN.R-project.org/package=bslib">https://CRAN.R-project.org/package=bslib</a>.
</div>
<div id="ref-inline" class="csl-entry" role="doc-biblioentry">
Sklyar, Oleg, Duncan Murdoch, Mike Smith, Dirk Eddelbuettel, Romain Francois, Karline Soetaert, and Johannes Ranke. 2021. <em><span class="nocase">inline</span>: Functions to Inline c, c++, Fortran Function Calls from r</em>. <a href="https://CRAN.R-project.org/package=inline">https://CRAN.R-project.org/package=inline</a>.
</div>
<div id="ref-StanHeaders" class="csl-entry" role="doc-biblioentry">
Stan Development Team. 2020. <span>“<span>StanHeaders</span>: Headers for the <span>R</span> Interface to <span>Stan</span>.”</span> <a href="https://mc-stan.org/">https://mc-stan.org/</a>.
</div>
<div id="ref-rstan" class="csl-entry" role="doc-biblioentry">
———. 2023. <span>“<span>RStan</span>: The <span>R</span> Interface to <span>Stan</span>.”</span> <a href="https://mc-stan.org/">https://mc-stan.org/</a>.
</div>
<div id="ref-colorspace2009c" class="csl-entry" role="doc-biblioentry">
Stauffer, Reto, Georg J. Mayr, Markus Dabernig, and Achim Zeileis. 2009. <span>“Somewhere over the Rainbow: How to Make Effective Use of Colors in Meteorological Visualizations.”</span> <em>Bulletin of the American Meteorological Society</em> 96 (2): 203–16. <a href="https://doi.org/10.1175/BAMS-D-13-00155.1">https://doi.org/10.1175/BAMS-D-13-00155.1</a>.
</div>
<div id="ref-base64enc" class="csl-entry" role="doc-biblioentry">
Urbanek, Simon. 2015. <em>Base64enc: Tools for Base64 Encoding</em>. <a href="https://CRAN.R-project.org/package=base64enc">https://CRAN.R-project.org/package=base64enc</a>.
</div>
<div id="ref-sourcetools" class="csl-entry" role="doc-biblioentry">
Ushey, Kevin. 2023. <em><span class="nocase">sourcetools</span>: Tools for Reading, Tokenizing and Parsing r Code</em>. <a href="https://CRAN.R-project.org/package=sourcetools">https://CRAN.R-project.org/package=sourcetools</a>.
</div>
<div id="ref-renv" class="csl-entry" role="doc-biblioentry">
Ushey, Kevin, and Hadley Wickham. 2023. <em><span class="nocase">renv</span>: Project Environments</em>. <a href="https://CRAN.R-project.org/package=renv">https://CRAN.R-project.org/package=renv</a>.
</div>
<div id="ref-htmlwidgets" class="csl-entry" role="doc-biblioentry">
Vaidyanathan, Ramnath, Yihui Xie, JJ Allaire, Joe Cheng, Carson Sievert, and Kenton Russell. 2023. <em><span class="nocase">htmlwidgets</span>: HTML Widgets for r</em>. <a href="https://CRAN.R-project.org/package=htmlwidgets">https://CRAN.R-project.org/package=htmlwidgets</a>.
</div>
<div id="ref-tensorA" class="csl-entry" role="doc-biblioentry">
van den Boogaart, K. Gerald. 2020. <em><span class="nocase">tensorA</span>: Advanced Tensor Arithmetic with Named Indices</em>. <a href="https://CRAN.R-project.org/package=tensorA">https://CRAN.R-project.org/package=tensorA</a>.
</div>
<div id="ref-dygraphs" class="csl-entry" role="doc-biblioentry">
Vanderkam, Dan, JJ Allaire, Jonathan Owen, Daniel Gromer, and Benoit Thieurmel. 2018. <em><span class="nocase">dygraphs</span>: Interface to <span>“<span>Dygraphs</span>”</span> Interactive Time Series Charting Library</em>. <a href="https://CRAN.R-project.org/package=dygraphs">https://CRAN.R-project.org/package=dygraphs</a>.
</div>
<div id="ref-loo2023a" class="csl-entry" role="doc-biblioentry">
Vehtari, Aki, Jonah Gabry, Mans Magnusson, Yuling Yao, Paul-Christian Bürkner, Topi Paananen, and Andrew Gelman. 2023. <span>“<span class="nocase">loo</span>: Efficient Leave-One-Out Cross-Validation and WAIC for Bayesian Models.”</span> <a href="https://mc-stan.org/loo/">https://mc-stan.org/loo/</a>.
</div>
<div id="ref-loo2017b" class="csl-entry" role="doc-biblioentry">
Vehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. <span>“Practical Bayesian Model Evaluation Using Leave-One-Out Cross-Validation and WAIC.”</span> <em>Statistics and Computing</em> 27: 1413–32. <a href="https://doi.org/10.1007/s11222-016-9696-4">https://doi.org/10.1007/s11222-016-9696-4</a>.
</div>
<div id="ref-posterior2021" class="csl-entry" role="doc-biblioentry">
Vehtari, Aki, Andrew Gelman, Daniel Simpson, Bob Carpenter, and Paul-Christian Bürkner. 2021. <span>“Rank-Normalization, Folding, and Localization: An Improved Rhat for Assessing Convergence of MCMC (with Discussion).”</span> <em>Bayesian Analysis</em>.
</div>
<div id="ref-munsell" class="csl-entry" role="doc-biblioentry">
Wickham, Charlotte. 2018. <em><span class="nocase">munsell</span>: Utilities for Using Munsell Colours</em>. <a href="https://CRAN.R-project.org/package=munsell">https://CRAN.R-project.org/package=munsell</a>.
</div>
<div id="ref-reshape2" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2007. <span>“Reshaping Data with the <span class="nocase">reshape</span> Package.”</span> <em>Journal of Statistical Software</em> 21 (12): 1–20. <a href="http://www.jstatsoft.org/v21/i12/">http://www.jstatsoft.org/v21/i12/</a>.
</div>
<div id="ref-plyr" class="csl-entry" role="doc-biblioentry">
———. 2011. <span>“The Split-Apply-Combine Strategy for Data Analysis.”</span> <em>Journal of Statistical Software</em> 40 (1): 1–29. <a href="https://www.jstatsoft.org/v40/i01/">https://www.jstatsoft.org/v40/i01/</a>.
</div>
<div id="ref-lazyeval" class="csl-entry" role="doc-biblioentry">
———. 2019. <em><span class="nocase">lazyeval</span>: Lazy (Non-Standard) Evaluation</em>. <a href="https://CRAN.R-project.org/package=lazyeval">https://CRAN.R-project.org/package=lazyeval</a>.
</div>
<div id="ref-ellipsis" class="csl-entry" role="doc-biblioentry">
———. 2021. <em><span class="nocase">ellipsis</span>: Tools for Working with ...</em> <a href="https://CRAN.R-project.org/package=ellipsis">https://CRAN.R-project.org/package=ellipsis</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-vctrs" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Lionel Henry, and Davis Vaughan. 2023. <em><span class="nocase">vctrs</span>: Vector Helpers</em>. <a href="https://CRAN.R-project.org/package=vctrs">https://CRAN.R-project.org/package=vctrs</a>.
</div>
<div id="ref-memoise" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Jim Hester, Winston Chang, Kirill Müller, and Daniel Cook. 2021. <em><span class="nocase">memoise</span>: <span>“<span>Memoisation</span>”</span> of Functions</em>. <a href="https://CRAN.R-project.org/package=memoise">https://CRAN.R-project.org/package=memoise</a>.
</div>
<div id="ref-pkgbuild" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Jim Hester, and Gábor Csárdi. 2023. <em><span class="nocase">pkgbuild</span>: Find Tools Needed to Build r Packages</em>. <a href="https://CRAN.R-project.org/package=pkgbuild">https://CRAN.R-project.org/package=pkgbuild</a>.
</div>
<div id="ref-generics" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Max Kuhn, and Davis Vaughan. 2022. <em><span class="nocase">generics</span>: Common S3 Generics Not Provided by Base r Methods Related to Model Fitting</em>. <a href="https://CRAN.R-project.org/package=generics">https://CRAN.R-project.org/package=generics</a>.
</div>
<div id="ref-gtable" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Thomas Lin Pedersen. 2023. <em><span class="nocase">gtable</span>: Arrange <span>“<span>Grobs</span>”</span> in Tables</em>. <a href="https://CRAN.R-project.org/package=gtable">https://CRAN.R-project.org/package=gtable</a>.
</div>
<div id="ref-scales" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Dana Seidel. 2022. <em><span class="nocase">scales</span>: Scale Functions for Visualization</em>. <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-isoband" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Claus O. Wilke, and Thomas Lin Pedersen. 2022. <em><span class="nocase">isoband</span>: Generate Isolines and Isobands from Regularly Spaced Elevation Grids</em>. <a href="https://CRAN.R-project.org/package=isoband">https://CRAN.R-project.org/package=isoband</a>.
</div>
<div id="ref-evaluate" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Yihui Xie. 2023. <em><span class="nocase">evaluate</span>: Parsing and Evaluation Tools That Provide More Details Than the Default</em>. <a href="https://CRAN.R-project.org/package=evaluate">https://CRAN.R-project.org/package=evaluate</a>.
</div>
<div id="ref-ggridges" class="csl-entry" role="doc-biblioentry">
Wilke, Claus O. 2022. <em><span class="nocase">ggridges</span>: Ridgeline Plots in <span>“<span class="nocase">ggplot2</span>”</span></em>. <a href="https://CRAN.R-project.org/package=ggridges">https://CRAN.R-project.org/package=ggridges</a>.
</div>
<div id="ref-knitr2014" class="csl-entry" role="doc-biblioentry">
Xie, Yihui. 2014. <span>“<span class="nocase">knitr</span>: A Comprehensive Tool for Reproducible Research in <span>R</span>.”</span> In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry" role="doc-biblioentry">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-tinytex2019" class="csl-entry" role="doc-biblioentry">
———. 2019. <span>“<span>TinyTeX</span>: A Lightweight, Cross-Platform, and Easy-to-Maintain LaTeX Distribution Based on TeX Live.”</span> <em>TUGboat</em> 40 (1): 30–32. <a href="https://tug.org/TUGboat/Contents/contents40-1.html">https://tug.org/TUGboat/Contents/contents40-1.html</a>.
</div>
<div id="ref-mime" class="csl-entry" role="doc-biblioentry">
———. 2021. <em><span class="nocase">mime</span>: Map Filenames to MIME Types</em>. <a href="https://CRAN.R-project.org/package=mime">https://CRAN.R-project.org/package=mime</a>.
</div>
<div id="ref-knitr2023" class="csl-entry" role="doc-biblioentry">
———. 2023a. <em><span class="nocase">knitr</span>: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-tinytex2023" class="csl-entry" role="doc-biblioentry">
———. 2023b. <em><span class="nocase">tinytex</span>: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents</em>. <a href="https://github.com/rstudio/tinytex">https://github.com/rstudio/tinytex</a>.
</div>
<div id="ref-xfun" class="csl-entry" role="doc-biblioentry">
———. 2023c. <em><span class="nocase">xfun</span>: Supporting Functions for Packages Maintained by <span>“<span>Yihui Xie</span>”</span></em>. <a href="https://CRAN.R-project.org/package=xfun">https://CRAN.R-project.org/package=xfun</a>.
</div>
<div id="ref-rmarkdown2018" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown: The Definitive Guide</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-markdown" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, JJ Allaire, and Jeffrey Horner. 2023. <em><span class="nocase">markdown</span>: Render Markdown with <span>“<span class="nocase">commonmark</span>”</span></em>. <a href="https://CRAN.R-project.org/package=markdown">https://CRAN.R-project.org/package=markdown</a>.
</div>
<div id="ref-DT" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, Joe Cheng, and Xianying Tan. 2023. <em><span>DT</span>: A Wrapper of the JavaScript Library <span>“<span>DataTables</span>”</span></em>. <a href="https://CRAN.R-project.org/package=DT">https://CRAN.R-project.org/package=DT</a>.
</div>
<div id="ref-rmarkdown2020" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R Markdown Cookbook</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
<div id="ref-highr" class="csl-entry" role="doc-biblioentry">
Xie, Yihui, and Yixuan Qiu. 2022. <em><span class="nocase">highr</span>: Syntax Highlighting for r Source Code</em>. <a href="https://CRAN.R-project.org/package=highr">https://CRAN.R-project.org/package=highr</a>.
</div>
<div id="ref-loo2017c" class="csl-entry" role="doc-biblioentry">
Yao, Yuling, Aki Vehtari, Daniel Simpson, and Andrew Gelman. 2017. <span>“Using Stacking to Average Bayesian Predictive Distributions.”</span> <em>Bayesian Analysis</em>. <a href="https://doi.org/10.1214/17-BA1091">https://doi.org/10.1214/17-BA1091</a>.
</div>
<div id="ref-colorspace2020a" class="csl-entry" role="doc-biblioentry">
Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross Ihaka, Claire D. McWhite, Paul Murrell, Reto Stauffer, and Claus O. Wilke. 2020. <span>“<span class="nocase">colorspace</span>: A Toolbox for Manipulating and Assessing Colors and Palettes.”</span> <em>Journal of Statistical Software</em> 96 (1): 1–49. <a href="https://doi.org/10.18637/jss.v096.i01">https://doi.org/10.18637/jss.v096.i01</a>.
</div>
<div id="ref-zoo" class="csl-entry" role="doc-biblioentry">
Zeileis, Achim, and Gabor Grothendieck. 2005. <span>“<span class="nocase">zoo</span>: S3 Infrastructure for Regular and Irregular Time Series.”</span> <em>Journal of Statistical Software</em> 14 (6): 1–27. <a href="https://doi.org/10.18637/jss.v014.i06">https://doi.org/10.18637/jss.v014.i06</a>.
</div>
<div id="ref-colorspace2009b" class="csl-entry" role="doc-biblioentry">
Zeileis, Achim, Kurt Hornik, and Paul Murrell. 2009. <span>“Escaping <span>RGB</span>land: Selecting Colors for Statistical Graphics.”</span> <em>Computational Statistics &amp; Data Analysis</em> 53 (9): 3259–70. <a href="https://doi.org/10.1016/j.csda.2008.11.033">https://doi.org/10.1016/j.csda.2008.11.033</a>.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>